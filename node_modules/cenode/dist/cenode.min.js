var CENode=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={exports:{},id:n,loaded:false};e[n].call(a.exports,a,a.exports,r);a.loaded=true;return a.exports}r.m=e;r.c=t;r.p="";return r(0)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=r(4);var s=r(48);var o=r(51);var f=r(52);var u=r(53);var l=function(){n(e,[{key:"newInstanceId",value:function e(){this.lastInstanceId+=1;return this.lastInstanceId}},{key:"newConceptId",value:function e(){this.lastConceptId+=1;return this.lastConceptId}},{key:"newCardId",value:function e(){if(!this.agent){return null}this.lastCardId+=1;return this.agent.name+this.lastCardId}},{key:"getConceptById",value:function e(t){return this.conceptDict[t]}},{key:"getConceptByName",value:function e(t){if(!t){return null}var r=true;var n=false;var a=undefined;try{for(var i=this.concepts[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.name.toLowerCase()===t.toLowerCase()){return o}var f=true;var u=false;var l=undefined;try{for(var h=o.synonyms[Symbol.iterator](),c;!(f=(c=h.next()).done);f=true){var d=c.value;if(d.toLowerCase()===t.toLowerCase()){return o}}}catch(e){u=true;l=e}finally{try{if(!f&&h.return){h.return()}}finally{if(u){throw l}}}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return null}},{key:"getInstanceById",value:function e(t){return this.instanceDict[t]}},{key:"getInstanceByName",value:function e(t,r){if(!t){return null}var n=true;var a=false;var i=undefined;try{for(var s=this.instances[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;if(f&&(r?r.id===f.concept.id:true)){if(f.name.toLowerCase()===t.toLowerCase()){return f}var u=true;var l=false;var h=undefined;try{for(var c=f.synonyms[Symbol.iterator](),d;!(u=(d=c.next()).done);u=true){var p=d.value;if(p.toLowerCase()===t.toLowerCase()){return f}}}catch(e){l=true;h=e}finally{try{if(!u&&c.return){c.return()}}finally{if(l){throw h}}}}}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}return null}},{key:"getInstances",value:function e(t,r){var n=[];if(!t){var a=true;var i=false;var s=undefined;try{for(var o=this.instances[Symbol.iterator](),f;!(a=(f=o.next()).done);a=true){var u=f.value;n.push(u)}}catch(e){i=true;s=e}finally{try{if(!a&&o.return){o.return()}}finally{if(i){throw s}}}}else if(t&&!r){var l=this.getConceptByName(t);if(l){var h=true;var c=false;var d=undefined;try{for(var p=this.instances[Symbol.iterator](),v;!(h=(v=p.next()).done);h=true){var y=v.value;if(y&&y.concept.id===l.id){n.push(y)}}}catch(e){c=true;d=e}finally{try{if(!h&&p.return){p.return()}}finally{if(c){throw d}}}}}else if(t&&r===true){var m=this.getConceptByName(t);if(m){var g=m.descendants.concat(m);var b=[];var w=true;var _=false;var C=undefined;try{for(var A=g[Symbol.iterator](),x;!(w=(x=A.next()).done);w=true){var S=x.value;b.push(S.id)}}catch(e){_=true;C=e}finally{try{if(!w&&A.return){A.return()}}finally{if(_){throw C}}}var I=true;var k=false;var E=undefined;try{for(var R=this.instances[Symbol.iterator](),L;!(I=(L=R.next()).done);I=true){var T=L.value;if(T&&b.indexOf(T.concept.id)>-1){n.push(T)}}}catch(e){k=true;E=e}finally{try{if(!I&&R.return){R.return()}}finally{if(k){throw E}}}}}return n}},{key:"addSentence",value:function e(t,r){var n=this.addCE(t,false,r);if(n.success){return n}var a=this.askQuestion(t);if(a.success){return a}return this.addNL(t)}},{key:"addSentences",value:function e(t,r){var n=[];var a=true;var i=false;var s=undefined;try{for(var o=t[Symbol.iterator](),f;!(a=(f=o.next()).done);a=true){var u=f.value;n.push(this.addSentence(u,r))}}catch(e){i=true;s=e}finally{try{if(!a&&o.return){o.return()}}finally{if(i){throw s}}}return n}},{key:"addCE",value:function e(t,r){var n=this.ceParser.parse(t.trim().replace("{now}",(new Date).getTime()).replace("{uid}",this.newCardId()),r);return{success:n[0],type:"gist",data:n[1],result:n[2]||undefined}}},{key:"askQuestion",value:function e(t){var r=this.questionParser.parse(t);return{success:r[0],type:r[0]?"gist":undefined,data:r[0]?r[1]:undefined}}},{key:"addNL",value:function e(t){var r=this.nlParser.parse(t);return{type:r[0]?"confirm":"gist",data:r[1]}}},{key:"loadModel",value:function e(t){var r=[];if(t&&t.length){var n=true;var a=false;var i=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;r.push(this.addCE(f))}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}}return r}},{key:"resetAll",value:function e(){this.instances=[];this.concepts=[]}},{key:"attachAgent",value:function e(t){this.agent=t||new i(this)}}]);function e(){a(this,e);this.ceParser=new s(this);this.questionParser=new o(this);this.nlParser=new f(this);this.ruleEngine=new u(this);this.concepts=[];this.instances=[];this.conceptDict={};this.instanceDict={};this.conceptIds={};this.lastInstanceId=this.instances.length;this.lastConceptId=this.concepts.length;this.lastCardId=0;for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}var i=true;var l=false;var h=undefined;try{for(var c=r[Symbol.iterator](),d;!(i=(d=c.next()).done);i=true){var p=d.value;this.loadModel(p)}}catch(e){l=true;h=e}finally{try{if(!i&&c.return){c.return()}}finally{if(l){throw h}}}}return e}();e.exports=l},,,,function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=r(5);var s=r(6);var o="Moira";var f=function(){function e(t){a(this,e);if(!t){throw new Error("CEAgents must be instantiated with a CENode object")}this.node=t;this.handledCards=[];this.cardHandler=new i(this);this.policyHandler=new s(this);this.setName(o);this.pollCards();this.enactPolicies()}n(e,[{key:"setName",value:function e(t){this.name=t;this.node.addSentence("there is an agent named "+t)}},{key:"getInstance",value:function e(){var t=this.node.getInstances("agent");var r=true;var n=false;var a=undefined;try{for(var i=t[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.name.toLowerCase()===name.toLowerCase()){return o}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return null}},{key:"pollCards",value:function e(){var t=this;if(setTimeout){setTimeout(function(){var e=t.node.getInstances("card",true);var r=true;var n=false;var a=undefined;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;t.cardHandler.handle(o)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}t.pollCards()},500)}}},{key:"enactPolicies",value:function e(){var t=this;if(setTimeout){setTimeout(function(){var e=t.node.getInstances("policy",true);var r=true;var n=false;var a=undefined;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;t.policyHandler.handle(o)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}t.enactPolicies()},5e3)}}}]);return e}();e.exports=f},function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t){var r=this;n(this,e);this.agent=t;this.node=t.node;this.handlers={"ask card":function e(t){var n=r.node.askQuestion(t.content);var a=true;var i=false;var s=undefined;try{for(var o=r.node.getInstances("ask policy")[Symbol.iterator](),f;!(a=(f=o.next()).done);a=true){var u=f.value;if(u.enabled==="true"&&u.target&&u.target.name){var l=u.target.name;if(!(l in r.agent.policyHandler.unsentAskCards)){r.agent.policyHandler.unsentAskCards[l]=[]}r.agent.policyHandler.unsentAskCards[l].push(t)}}}catch(e){i=true;s=e}finally{try{if(!a&&o.return){o.return()}}finally{if(i){throw s}}}if(t.is_from){var h=void 0;var c=void 0;if(n.data){h=n.data.match(/(https?:\/\/[a-zA-Z0-9.\/\-+_&=?!%]*)/gi);c="there is a "+n.type+" card named 'msg_{uid}' that is from the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has '"+n.data.replace(/'/g,"\\'")+"' as content"}else{c="there is a gist card named 'msg_{uid}' that is from the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has 'Sorry; your question was not understood.' as content"}var d=true;var p=false;var v=undefined;try{for(var y=t.is_froms[Symbol.iterator](),m;!(d=(m=y.next()).done);d=true){var g=m.value;c+=" and is to the "+g.type.name+" '"+g.name+"'"}}catch(e){p=true;v=e}finally{try{if(!d&&y.return){y.return()}}finally{if(p){throw v}}}if(h){var b=true;var w=false;var _=undefined;try{for(var C=h[Symbol.iterator](),A;!(b=(A=C.next()).done);b=true){var x=A.value;c+=" and has '"+x+"' as linked content"}}catch(e){w=true;_=e}finally{try{if(!b&&C.return){C.return()}}finally{if(w){throw _}}}}c+=" and is in reply to the card '"+t.name+"'";return r.node.addSentence(c)}return null},"tell card":function e(t){var n=r.node.addCE(t.content,t.is_from&&t.is_from.name);if(!n.success&&t.is_from){return r.node.addSentence("there is a gist card named 'msg_{uid}' that is from the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and is to the "+t.is_from.type.name+" '"+t.is_from.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has 'Sorry. Your input was not understood.' as content and is in reply to the card '"+t.name+"'.")}if(n.success===true){var a=true;var i=false;var s=undefined;try{for(var o=r.node.getInstances("tell policy")[Symbol.iterator](),f;!(a=(f=o.next()).done);a=true){var u=f.value;if(u.enabled==="true"&&u.target&&u.target.name){var l=u.target.name;if(!(l in r.agent.policyHandler.unsentTellCards)){r.agent.policyHandler.unsentTellCards[l]=[]}r.agent.policyHandler.unsentTellCards[l].push(t)}}}catch(e){i=true;s=e}finally{try{if(!a&&o.return){o.return()}}finally{if(i){throw s}}}}if(t.is_from){var h=true;var c=false;var d=undefined;try{for(var p=r.node.getInstances("feedback policy")[Symbol.iterator](),v;!(h=(v=p.next()).done);h=true){var y=v.value;if(y.enabled==="true"&&y.target&&y.target.name){var m=y.acknowledgement;if(y.target.name.toLowerCase()===t.is_from.name.toLowerCase()){var g=void 0;if(m==="basic"){g="OK."}else if(n.type==="tell"){g="OK. I added this to my knowledge base: "+n.data}else if(n.type==="ask"||n.type==="confirm"||n.type==="gist"){g=n.data}return r.node.addSentence("there is a "+n.type+" card named 'msg_{uid}' that is from the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and is to the "+t.is_from.type.name+" '"+t.is_from.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has '"+g.replace(/'/g,"\\'")+"' as content and is in reply to the card '"+t.name+"'.")}}}}catch(e){c=true;d=e}finally{try{if(!h&&p.return){p.return()}}finally{if(c){throw d}}}}return null},"nl card":function e(t){var n=r.node.addCE(t.content,t.is_from&&t.is_from.name);if(n.success){return r.node.addSentence("there is a tell card named 'msg_{uid}' that is from the "+t.is_from.type.name+" '"+t.is_from.name.replace(/'/g,"\\'")+"' and is to the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has '"+t.content.replace(/'/g,"\\'")+"' as content.")}n=r.node.askQuestion(t.content);if(n.success){return r.node.addSentence("there is an ask card named 'msg_{uid}' that is from the "+t.is_from.type.name+" '"+t.is_from.name.replace(/'/g,"\\'")+"' and is to the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has '"+t.content.replace(/'/g,"\\'")+"' as content.")}n=r.node.addNL(t.content);return r.node.addSentence("there is a "+n.type+" card named 'msg_{uid}' that is from the agent '"+r.agent.name.replace(/'/g,"\\'")+"' and is to the "+t.is_from.type.name+" '"+t.is_from.name.replace(/'/g,"\\'")+"' and has the timestamp '{now}' as timestamp and has '"+n.data.replace(/'/g,"\\'")+"' as content and is in reply to the card '"+t.name+"'.")}}}r(e,[{key:"handle",value:function e(t){if(t.type.name in this.handlers&&t.is_tos&&t.content&&this.agent.handledCards.indexOf(t.name)===-1){var r=true;var n=false;var a=undefined;try{for(var i=t.is_tos[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.name.toLowerCase()===this.agent.name.toLowerCase()){this.handlers[t.type.name](t);this.agent.handledCards.push(t.name);break}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}}}}]);return e}();e.exports=a},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i="/sentences";var s="/cards";var o={makeRequest:function e(t,r,n,a,i){try{if(typeof window!=="undefined"&&window.document){o.makeRequestClient(t,r,n,a,i)}else{o.makeRequestNode(t,r,n,a,i)}}catch(e){}},makeRequestClient:function e(t,r,n,a,i){var s=r.indexOf("http://")===-1?"http://"+r:r;var o=new XMLHttpRequest;o.open(t,s+n);o.onreadystatechange=function(){if(o.readyState===4&&(o.status===200||o.status===302)&&i){i(o.responseText)}};if(a){o.setRequestHeader("Content-type","application/x-www-form-urlencoded");o.send(a)}else{o.send()}},makeRequestNode:function e(t,n,a,i,s){var o=n.match(/.*:([0-9]*)/);var f=n;if(o){f=n.replace(/:[0-9]*/,"")}var u={hostname:f,path:a,port:o?parseInt(o[1],10):80,method:"POST"};if(t==="POST"){var l=r(7).request(u,function(e){var t="";e.on("data",function(e){t+=e});e.on("end",function(){if(s){s(t)}})});l.on("error",function(){});l.write(i);l.end()}}};var f=function(){function e(t){var r=this;a(this,e);this.agent=t;this.node=t.node;this.unsentTellCards={};this.unsentAskCards={};this.lastSuccessfulRequest=0;this.handlers={"tell policy":function e(t){if(t.target&&t.target.name&&t.target.address){if(!(t.target.name in r.unsentTellCards)){r.unsentTellCards[t.target.name]=[]}var n="";var a=true;var s=false;var f=undefined;try{for(var u=r.unsentTellCards[t.target.name][Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var h=l.value;if(h.is_tos&&h.is_from.name.toLowerCase()!==t.target.name.toLowerCase()){var c=false;var d=true;var p=false;var v=undefined;try{for(var y=h.is_tos[Symbol.iterator](),m;!(d=(m=y.next()).done);d=true){var g=m.value;if(g.id===t.target.id){c=true;break}}}catch(e){p=true;v=e}finally{try{if(!d&&y.return){y.return()}}finally{if(p){throw v}}}if(!c){h.addRelationship("is to",t.target)}n+=h.ce+"\n"}}}catch(e){s=true;f=e}finally{try{if(!a&&u.return){u.return()}}finally{if(s){throw f}}}if(n.length){o.makeRequest("POST",t.target.address,i,n,function(){r.lastSuccessfulRequest=(new Date).getTime();r.unsentTellCards[t.target.name]=[]})}}},"ask policy":function e(t){if(t.target&&t.target.name){if(!(t.target.name in r.unsentAskCards)){r.unsentAskCards[t.target.name]=[]}var n="";var a=true;var s=false;var f=undefined;try{for(var u=r.unsentAskCards[t.target.name][Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var h=l.value;var c=h.is_froms;var d=h.is_tos;if(d&&h.is_from&&h.is_from.name.toLowerCase()!==t.target.name.toLowerCase()){var p=false;var v=true;var y=false;var m=undefined;try{for(var g=d[Symbol.iterator](),b;!(v=(b=g.next()).done);v=true){var w=b.value;if(w.id===t.target.id){p=true;break}}}catch(e){y=true;m=e}finally{try{if(!v&&g.return){g.return()}}finally{if(y){throw m}}}if(!p){h.addRelationship("is to",t.target)}p=false;var _=true;var C=false;var A=undefined;try{for(var x=c[Symbol.iterator](),S;!(_=(S=x.next()).done);_=true){var I=S.value;if(I.id===r.agent.getInstance().id){p=true;break}}}catch(e){C=true;A=e}finally{try{if(!_&&x.return){x.return()}}finally{if(C){throw A}}}if(!p){h.addRelationship("is from",r.agent.getInstance())}n+=h.ce+"\n"}}}catch(e){s=true;f=e}finally{try{if(!a&&u.return){u.return()}}finally{if(s){throw f}}}if(n.length){o.makeRequest("POST",t.target.address,i,n,function(){r.lastSuccessfulRequest=(new Date).getTime();r.unsentAskCards[t.target.name]=[]})}}},"listen policy":function e(t){if(t.target&&t.target.address){var n="";var a=true;var i=false;var f=undefined;try{for(var u=r.node.getInstances("card",true)[Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var h=l.value;n=n+h.name+"\n"}}catch(e){i=true;f=e}finally{try{if(!a&&u.return){u.return()}}finally{if(i){throw f}}}o.makeRequest("POST",t.target.address,s+"?agent="+r.agent.name,n,function(e){r.lastSuccessfulRequest=(new Date).getTime();r.node.addSentences(e.split("\n"))})}},"forwardall policy":function e(t){var n=t.all_agents==="true"?r.node.getInstances("agent"):t.targets;var a=r.node.getInstances("tell card");if(t.start_time){var i=t.start_time;var s=true;var o=false;var f=undefined;try{for(var u=a[Symbol.iterator](),l;!(s=(l=u.next()).done);s=true){var h=l.value;if(h.timestamp&&h.is_froms.length){var c=false;var d=h.is_tos;var p=h.is_froms[0];var v=h.timestamp.name;if(d&&parseInt(v,10)>parseInt(i,10)){var y=true;var m=false;var g=undefined;try{for(var b=d[Symbol.iterator](),w;!(y=(w=b.next()).done);y=true){var _=w.value;if(_.name===r.agent.name){c=true;break}}}catch(e){m=true;g=e}finally{try{if(!y&&b.return){b.return()}}finally{if(m){throw g}}}if(c){var C=true;var A=false;var x=undefined;try{for(var S=n[Symbol.iterator](),I;!(C=(I=S.next()).done);C=true){var k=I.value;var E=false;var R=true;var L=false;var T=undefined;try{for(var O=d[Symbol.iterator](),B;!(R=(B=O.next()).done);R=true){var P=B.value;if(P.name.toLowerCase()===k.name.toLowerCase()){E=true;break}}}catch(e){L=true;T=e}finally{try{if(!R&&O.return){O.return()}}finally{if(L){throw T}}}if(!E&&k.name.toLowerCase()!==r.agent.name.toLowerCase()&&k.name.toLowerCase()!==p.name.toLowerCase()){h.addRelationship("is to",k)}}}catch(e){A=true;x=e}finally{try{if(!C&&S.return){S.return()}}finally{if(A){throw x}}}}}}}}catch(e){o=true;f=e}finally{try{if(!s&&u.return){u.return()}}finally{if(o){throw f}}}}}}}n(e,[{key:"handle",value:function e(t){if(t.enabled==="true"&&t.type.name in this.handlers){this.handlers[t.type.name](t)}}}]);return e}();e.exports=f},function(e,t,r){(function(e){var n=r(8);var a=r(39);var i=r(40);var s=r(41);var o=t;o.request=function(t,r){if(typeof t==="string")t=s.parse(t);else t=a(t);var i=e.location.protocol.search(/^https?:$/)===-1?"http:":"";var o=t.protocol||i;var f=t.hostname||t.host;var u=t.port;var l=t.path||"/";if(f&&f.indexOf(":")!==-1)f="["+f+"]";t.url=(f?o+"//"+f:"")+(u?":"+u:"")+l;t.method=(t.method||"GET").toUpperCase();t.headers=t.headers||{};var h=new n(t);if(r)h.on("response",r);return h};o.get=function e(t,r){var n=o.request(t,r);n.end();return n};o.Agent=function(){};o.Agent.defaultMaxSockets=4;o.STATUS_CODES=i;o.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(t,function(){return this}())},function(e,t,r){(function(t,n,a){var i=r(14);var s=r(15);var o=r(16);var f=r(17);var u=r(38);var l=o.IncomingMessage;var h=o.readyStates;function c(e,t){if(i.fetch&&t){return"fetch"}else if(i.mozchunkedarraybuffer){return"moz-chunked-arraybuffer"}else if(i.msstream){return"ms-stream"}else if(i.arraybuffer&&e){return"arraybuffer"}else if(i.vbArray&&e){return"text:vbarray"}else{return"text"}}var d=e.exports=function(e){var r=this;f.Writable.call(r);r._opts=e;r._body=[];r._headers={};if(e.auth)r.setHeader("Authorization","Basic "+new t(e.auth).toString("base64"));Object.keys(e.headers).forEach(function(t){r.setHeader(t,e.headers[t])});var n;var a=true;if(e.mode==="disable-fetch"){a=false;n=true}else if(e.mode==="prefer-streaming"){n=false}else if(e.mode==="allow-wrong-content-type"){n=!i.overrideMimeType}else if(!e.mode||e.mode==="default"||e.mode==="prefer-fast"){n=true}else{throw new Error("Invalid value for opts.mode")}r._mode=c(n,a);r.on("finish",function(){r._onFinish()})};s(d,f.Writable);d.prototype.setHeader=function(e,t){var r=this;var n=e.toLowerCase();if(v.indexOf(n)!==-1)return;r._headers[n]={name:e,value:t}};d.prototype.getHeader=function(e){var t=this;return t._headers[e.toLowerCase()].value};d.prototype.removeHeader=function(e){var t=this;delete t._headers[e.toLowerCase()]};d.prototype._onFinish=function(){var e=this;if(e._destroyed)return;var r=e._opts;var s=e._headers;var o;if(r.method==="POST"||r.method==="PUT"||r.method==="PATCH"||r.method==="MERGE"){if(i.blobConstructor){o=new n.Blob(e._body.map(function(e){return u(e)}),{type:(s["content-type"]||{}).value||""})}else{o=t.concat(e._body).toString()}}if(e._mode==="fetch"){var f=Object.keys(s).map(function(e){return[s[e].name,s[e].value]});n.fetch(e._opts.url,{method:e._opts.method,headers:f,body:o,mode:"cors",credentials:r.withCredentials?"include":"same-origin"}).then(function(t){e._fetchResponse=t;e._connect()},function(t){e.emit("error",t)})}else{var l=e._xhr=new n.XMLHttpRequest;try{l.open(e._opts.method,e._opts.url,true)}catch(t){a.nextTick(function(){e.emit("error",t)});return}if("responseType"in l)l.responseType=e._mode.split(":")[0];if("withCredentials"in l)l.withCredentials=!!r.withCredentials;if(e._mode==="text"&&"overrideMimeType"in l)l.overrideMimeType("text/plain; charset=x-user-defined");Object.keys(s).forEach(function(e){l.setRequestHeader(s[e].name,s[e].value)});e._response=null;l.onreadystatechange=function(){switch(l.readyState){case h.LOADING:case h.DONE:e._onXHRProgress();break}};if(e._mode==="moz-chunked-arraybuffer"){l.onprogress=function(){e._onXHRProgress()}}l.onerror=function(){if(e._destroyed)return;e.emit("error",new Error("XHR error"))};try{l.send(o)}catch(t){a.nextTick(function(){e.emit("error",t)});return}}};function p(e){try{var t=e.status;return t!==null&&t!==0}catch(e){return false}}d.prototype._onXHRProgress=function(){var e=this;if(!p(e._xhr)||e._destroyed)return;if(!e._response)e._connect();e._response._onXHRProgress()};d.prototype._connect=function(){var e=this;if(e._destroyed)return;e._response=new l(e._xhr,e._fetchResponse,e._mode);e.emit("response",e._response)};d.prototype._write=function(e,t,r){var n=this;n._body.push(e);r()};d.prototype.abort=d.prototype.destroy=function(){var e=this;e._destroyed=true;if(e._response)e._response._destroyed=true;if(e._xhr)e._xhr.abort()};d.prototype.end=function(e,t,r){var n=this;if(typeof e==="function"){r=e;e=undefined}f.Writable.prototype.end.call(n,e,t,r)};d.prototype.flushHeaders=function(){};d.prototype.setTimeout=function(){};d.prototype.setNoDelay=function(){};d.prototype.setSocketKeepAlive=function(){};var v=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(t,r(9).Buffer,function(){return this}(),r(13))},function(e,t,r){(function(e){"use strict";var n=r(10);var a=r(11);var i=r(12);t.Buffer=u;t.SlowBuffer=b;t.INSPECT_MAX_BYTES=50;u.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==undefined?e.TYPED_ARRAY_SUPPORT:s();t.kMaxLength=o();function s(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(e){return false}}function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(e,t){if(o()<t){throw new RangeError("Invalid typed array length")}if(u.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=u.prototype}else{if(e===null){e=new u(t)}e.length=t}return e}function u(e,t,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u)){return new u(e,t,r)}if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return d(this,e)}return l(this,e,t,r)}u.poolSize=8192;u._augment=function(e){e.__proto__=u.prototype;return e};function l(e,t,r,n){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer){return y(e,t,r,n)}if(typeof t==="string"){return p(e,t,r)}return m(e,t)}u.from=function(e,t,r){return l(null,e,t,r)};if(u.TYPED_ARRAY_SUPPORT){u.prototype.__proto__=Uint8Array.prototype;u.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&u[Symbol.species]===u){Object.defineProperty(u,Symbol.species,{value:null,configurable:true})}}function h(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be a number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function c(e,t,r,n){h(t);if(t<=0){return f(e,t)}if(r!==undefined){return typeof n==="string"?f(e,t).fill(r,n):f(e,t).fill(r)}return f(e,t)}u.alloc=function(e,t,r){return c(null,e,t,r)};function d(e,t){h(t);e=f(e,t<0?0:g(t)|0);if(!u.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;++r){e[r]=0}}return e}u.allocUnsafe=function(e){return d(null,e)};u.allocUnsafeSlow=function(e){return d(null,e)};function p(e,t,r){if(typeof r!=="string"||r===""){r="utf8"}if(!u.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=w(t,r)|0;e=f(e,n);var a=e.write(t,r);if(a!==n){e=e.slice(0,a)}return e}function v(e,t){var r=t.length<0?0:g(t.length)|0;e=f(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function y(e,t,r,n){t.byteLength;if(r<0||t.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(t.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){t=new Uint8Array(t)}else if(n===undefined){t=new Uint8Array(t,r)}else{t=new Uint8Array(t,r,n)}if(u.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=u.prototype}else{e=v(e,t)}return e}function m(e,t){if(u.isBuffer(t)){var r=g(t.length)|0;e=f(e,r);if(e.length===0){return e}t.copy(e,0,0,r);return e}if(t){if(typeof ArrayBuffer!=="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t){if(typeof t.length!=="number"||te(t.length)){return f(e,0)}return v(e,t)}if(t.type==="Buffer"&&i(t.data)){return v(e,t.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(e){if(e>=o()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+o().toString(16)+" bytes")}return e|0}function b(e){if(+e!=e){e=0}return u.alloc(+e)}u.isBuffer=function e(t){return!!(t!=null&&t._isBuffer)};u.compare=function e(t,r){if(!u.isBuffer(t)||!u.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var a=r.length;for(var i=0,s=Math.min(n,a);i<s;++i){if(t[i]!==r[i]){n=t[i];a=r[i];break}}if(n<a)return-1;if(a<n)return 1;return 0};u.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};u.concat=function e(t,r){if(!i(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return u.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var a=u.allocUnsafe(r);var s=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(a,s);s+=o.length}return a};function w(e,t){if(u.isBuffer(e)){return e.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return J(e).length;default:if(n)return X(e).length;t=(""+t).toLowerCase();n=true}}}u.byteLength=w;function _(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return j(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return M(this,t,r);case"latin1":case"binary":return U(this,t,r);case"base64":return T(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}u.prototype._isBuffer=true;function C(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}u.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){C(this,r,r+1)}return this};u.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){C(this,r,r+3);C(this,r+1,r+2)}return this};u.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){C(this,r,r+7);C(this,r+1,r+6);C(this,r+2,r+5);C(this,r+3,r+4)}return this};u.prototype.toString=function e(){var t=this.length|0;if(t===0)return"";if(arguments.length===0)return O(this,0,t);return _.apply(this,arguments)};u.prototype.equals=function e(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return u.compare(this,t)===0};u.prototype.inspect=function e(){var r="";var n=t.INSPECT_MAX_BYTES;if(this.length>0){r=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)r+=" ... "}return"<Buffer "+r+">"};u.prototype.compare=function e(t,r,n,a,i){if(!u.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(a===undefined){a=0}if(i===undefined){i=this.length}if(r<0||n>t.length||a<0||i>this.length){throw new RangeError("out of range index")}if(a>=i&&r>=n){return 0}if(a>=i){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;a>>>=0;i>>>=0;if(this===t)return 0;var s=i-a;var o=n-r;var f=Math.min(s,o);var l=this.slice(a,i);var h=t.slice(r,n);for(var c=0;c<f;++c){if(l[c]!==h[c]){s=l[c];o=h[c];break}}if(s<o)return-1;if(o<s)return 1;return 0};function A(e,t,r,n,a){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=a?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(a)return-1;else r=e.length-1}else if(r<0){if(a)r=0;else return-1}if(typeof t==="string"){t=u.from(t,n)}if(u.isBuffer(t)){if(t.length===0){return-1}return x(e,t,r,n,a)}else if(typeof t==="number"){t=t&255;if(u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(a){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return x(e,[t],r,n,a)}throw new TypeError("val must be string, number or Buffer")}function x(e,t,r,n,a){var i=1;var s=e.length;var o=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}i=2;s/=2;o/=2;r/=2}}function f(e,t){
if(i===1){return e[t]}else{return e.readUInt16BE(t*i)}}var u;if(a){var l=-1;for(u=r;u<s;u++){if(f(e,u)===f(t,l===-1?0:u-l)){if(l===-1)l=u;if(u-l+1===o)return l*i}else{if(l!==-1)u-=u-l;l=-1}}}else{if(r+o>s)r=s-o;for(u=r;u>=0;u--){var h=true;for(var c=0;c<o;c++){if(f(e,u+c)!==f(t,c)){h=false;break}}if(h)return u}}return-1}u.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};u.prototype.indexOf=function e(t,r,n){return A(this,t,r,n,true)};u.prototype.lastIndexOf=function e(t,r,n){return A(this,t,r,n,false)};function S(e,t,r,n){r=Number(r)||0;var a=e.length-r;if(!n){n=a}else{n=Number(n);if(n>a){n=a}}var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");if(n>i/2){n=i/2}for(var s=0;s<n;++s){var o=parseInt(t.substr(s*2,2),16);if(isNaN(o))return s;e[r+s]=o}return s}function I(e,t,r,n){return ee(X(t,e.length-r),e,r,n)}function k(e,t,r,n){return ee($(t),e,r,n)}function E(e,t,r,n){return k(e,t,r,n)}function R(e,t,r,n){return ee(J(t),e,r,n)}function L(e,t,r,n){return ee(Q(t,e.length-r),e,r,n)}u.prototype.write=function e(t,r,n,a){if(r===undefined){a="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){a=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(a===undefined)a="utf8"}else{a=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var i=this.length-r;if(n===undefined||n>i)n=i;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!a)a="utf8";var s=false;for(;;){switch(a){case"hex":return S(this,t,r,n);case"utf8":case"utf-8":return I(this,t,r,n);case"ascii":return k(this,t,r,n);case"latin1":case"binary":return E(this,t,r,n);case"base64":return R(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r,n);default:if(s)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase();s=true}}};u.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function O(e,t,r){r=Math.min(e.length,r);var n=[];var a=t;while(a<r){var i=e[a];var s=null;var o=i>239?4:i>223?3:i>191?2:1;if(a+o<=r){var f,u,l,h;switch(o){case 1:if(i<128){s=i}break;case 2:f=e[a+1];if((f&192)===128){h=(i&31)<<6|f&63;if(h>127){s=h}}break;case 3:f=e[a+1];u=e[a+2];if((f&192)===128&&(u&192)===128){h=(i&15)<<12|(f&63)<<6|u&63;if(h>2047&&(h<55296||h>57343)){s=h}}break;case 4:f=e[a+1];u=e[a+2];l=e[a+3];if((f&192)===128&&(u&192)===128&&(l&192)===128){h=(i&15)<<18|(f&63)<<12|(u&63)<<6|l&63;if(h>65535&&h<1114112){s=h}}}}if(s===null){s=65533;o=1}else if(s>65535){s-=65536;n.push(s>>>10&1023|55296);s=56320|s&1023}n.push(s);a+=o}return P(n)}var B=4096;function P(e){var t=e.length;if(t<=B){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=B))}return r}function M(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a]&127)}return n}function U(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a])}return n}function j(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var a="";for(var i=t;i<r;++i){a+=K(e[i])}return a}function N(e,t,r){var n=e.slice(t,r);var a="";for(var i=0;i<n.length;i+=2){a+=String.fromCharCode(n[i]+n[i+1]*256)}return a}u.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var a;if(u.TYPED_ARRAY_SUPPORT){a=this.subarray(t,r);a.__proto__=u.prototype}else{var i=r-t;a=new u(i,undefined);for(var s=0;s<i;++s){a[s]=this[s+t]}}return a};function z(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)z(t,r,this.length);var a=this[t];var i=1;var s=0;while(++s<r&&(i*=256)){a+=this[t+s]*i}return a};u.prototype.readUIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n){z(t,r,this.length)}var a=this[t+--r];var i=1;while(r>0&&(i*=256)){a+=this[t+--r]*i}return a};u.prototype.readUInt8=function e(t,r){if(!r)z(t,1,this.length);return this[t]};u.prototype.readUInt16LE=function e(t,r){if(!r)z(t,2,this.length);return this[t]|this[t+1]<<8};u.prototype.readUInt16BE=function e(t,r){if(!r)z(t,2,this.length);return this[t]<<8|this[t+1]};u.prototype.readUInt32LE=function e(t,r){if(!r)z(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};u.prototype.readUInt32BE=function e(t,r){if(!r)z(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};u.prototype.readIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)z(t,r,this.length);var a=this[t];var i=1;var s=0;while(++s<r&&(i*=256)){a+=this[t+s]*i}i*=128;if(a>=i)a-=Math.pow(2,8*r);return a};u.prototype.readIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n)z(t,r,this.length);var a=r;var i=1;var s=this[t+--a];while(a>0&&(i*=256)){s+=this[t+--a]*i}i*=128;if(s>=i)s-=Math.pow(2,8*r);return s};u.prototype.readInt8=function e(t,r){if(!r)z(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};u.prototype.readInt16LE=function e(t,r){if(!r)z(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function e(t,r){if(!r)z(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function e(t,r){if(!r)z(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};u.prototype.readInt32BE=function e(t,r){if(!r)z(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};u.prototype.readFloatLE=function e(t,r){if(!r)z(t,4,this.length);return a.read(this,t,true,23,4)};u.prototype.readFloatBE=function e(t,r){if(!r)z(t,4,this.length);return a.read(this,t,false,23,4)};u.prototype.readDoubleLE=function e(t,r){if(!r)z(t,8,this.length);return a.read(this,t,true,52,8)};u.prototype.readDoubleBE=function e(t,r){if(!r)z(t,8,this.length);return a.read(this,t,false,52,8)};function Z(e,t,r,n,a,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function e(t,r,n,a){t=+t;r=r|0;n=n|0;if(!a){var i=Math.pow(2,8*n)-1;Z(this,t,r,n,i,0)}var s=1;var o=0;this[r]=t&255;while(++o<n&&(s*=256)){this[r+o]=t/s&255}return r+n};u.prototype.writeUIntBE=function e(t,r,n,a){t=+t;r=r|0;n=n|0;if(!a){var i=Math.pow(2,8*n)-1;Z(this,t,r,n,i,0)}var s=n-1;var o=1;this[r+s]=t&255;while(--s>=0&&(o*=256)){this[r+s]=t/o&255}return r+n};u.prototype.writeUInt8=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,1,255,0);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);this[r]=t&255;return r+1};function D(e,t,r,n){if(t<0)t=65535+t+1;for(var a=0,i=Math.min(e.length-r,2);a<i;++a){e[r+a]=(t&255<<8*(n?a:1-a))>>>(n?a:1-a)*8}}u.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{D(this,t,r,true)}return r+2};u.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{D(this,t,r,false)}return r+2};function q(e,t,r,n){if(t<0)t=4294967295+t+1;for(var a=0,i=Math.min(e.length-r,4);a<i;++a){e[r+a]=t>>>(n?a:3-a)*8&255}}u.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255}else{q(this,t,r,true)}return r+4};u.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{q(this,t,r,false)}return r+4};u.prototype.writeIntLE=function e(t,r,n,a){t=+t;r=r|0;if(!a){var i=Math.pow(2,8*n-1);Z(this,t,r,n,i-1,-i)}var s=0;var o=1;var f=0;this[r]=t&255;while(++s<n&&(o*=256)){if(t<0&&f===0&&this[r+s-1]!==0){f=1}this[r+s]=(t/o>>0)-f&255}return r+n};u.prototype.writeIntBE=function e(t,r,n,a){t=+t;r=r|0;if(!a){var i=Math.pow(2,8*n-1);Z(this,t,r,n,i-1,-i)}var s=n-1;var o=1;var f=0;this[r+s]=t&255;while(--s>=0&&(o*=256)){if(t<0&&f===0&&this[r+s+1]!==0){f=1}this[r+s]=(t/o>>0)-f&255}return r+n};u.prototype.writeInt8=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,1,127,-128);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);if(t<0)t=255+t+1;this[r]=t&255;return r+1};u.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{D(this,t,r,true)}return r+2};u.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{D(this,t,r,false)}return r+2};u.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,4,2147483647,-2147483648);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else{q(this,t,r,true)}return r+4};u.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)Z(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{q(this,t,r,false)}return r+4};function F(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(e,t,r,n,i){if(!i){F(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}a.write(e,t,r,n,23,4);return r+4}u.prototype.writeFloatLE=function e(t,r,n){return H(this,t,r,true,n)};u.prototype.writeFloatBE=function e(t,r,n){return H(this,t,r,false,n)};function Y(e,t,r,n,i){if(!i){F(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}a.write(e,t,r,n,52,8);return r+8}u.prototype.writeDoubleLE=function e(t,r,n){return Y(this,t,r,true,n)};u.prototype.writeDoubleBE=function e(t,r,n){return Y(this,t,r,false,n)};u.prototype.copy=function e(t,r,n,a){if(!n)n=0;if(!a&&a!==0)a=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(a>0&&a<n)a=n;if(a===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");if(a>this.length)a=this.length;if(t.length-r<a-n){a=t.length-r+n}var i=a-n;var s;if(this===t&&n<r&&r<a){for(s=i-1;s>=0;--s){t[s+r]=this[s+n]}}else if(i<1e3||!u.TYPED_ARRAY_SUPPORT){for(s=0;s<i;++s){t[s+r]=this[s+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,n+i),r)}return i};u.prototype.fill=function e(t,r,n,a){if(typeof t==="string"){if(typeof r==="string"){a=r;r=0;n=this.length}else if(typeof n==="string"){a=n;n=this.length}if(t.length===1){var i=t.charCodeAt(0);if(i<256){t=i}}if(a!==undefined&&typeof a!=="string"){throw new TypeError("encoding must be a string")}if(typeof a==="string"&&!u.isEncoding(a)){throw new TypeError("Unknown encoding: "+a)}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var s;if(typeof t==="number"){for(s=r;s<n;++s){this[s]=t}}else{var o=u.isBuffer(t)?t:X(new u(t,a).toString());var f=o.length;for(s=0;s<n-r;++s){this[s+r]=o[s%f]}}return this};var W=/[^+\/0-9A-Za-z-_]/g;function V(e){e=G(e).replace(W,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function G(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function K(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function X(e,t){t=t||Infinity;var r;var n=e.length;var a=null;var i=[];for(var s=0;s<n;++s){r=e.charCodeAt(s);if(r>55295&&r<57344){if(!a){if(r>56319){if((t-=3)>-1)i.push(239,191,189);continue}else if(s+1===n){if((t-=3)>-1)i.push(239,191,189);continue}a=r;continue}if(r<56320){if((t-=3)>-1)i.push(239,191,189);a=r;continue}r=(a-55296<<10|r-56320)+65536}else if(a){if((t-=3)>-1)i.push(239,191,189)}a=null;if(r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return i}function $(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function Q(e,t){var r,n,a;var i=[];for(var s=0;s<e.length;++s){if((t-=2)<0)break;r=e.charCodeAt(s);n=r>>8;a=r%256;i.push(a);i.push(n)}return i}function J(e){return n.toByteArray(V(e))}function ee(e,t,r,n){for(var a=0;a<n;++a){if(a+r>=t.length||a>=e.length)break;t[a+r]=e[a]}return a}function te(e){return e!==e}}).call(t,function(){return this}())},function(e,t){"use strict";t.byteLength=u;t.toByteArray=l;t.fromByteArray=d;var r=[];var n=[];var a=typeof Uint8Array!=="undefined"?Uint8Array:Array;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,o=i.length;s<o;++s){r[s]=i[s];n[i.charCodeAt(s)]=s}n["-".charCodeAt(0)]=62;n["_".charCodeAt(0)]=63;function f(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return e[t-2]==="="?2:e[t-1]==="="?1:0}function u(e){return e.length*3/4-f(e)}function l(e){var t,r,i,s,o,u;var l=e.length;o=f(e);u=new a(l*3/4-o);i=o>0?l-4:l;var h=0;for(t=0,r=0;t<i;t+=4,r+=3){s=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)];u[h++]=s>>16&255;u[h++]=s>>8&255;u[h++]=s&255}if(o===2){s=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4;u[h++]=s&255}else if(o===1){s=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2;u[h++]=s>>8&255;u[h++]=s&255}return u}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[e&63]}function c(e,t,r){var n;var a=[];for(var i=t;i<r;i+=3){n=(e[i]<<16)+(e[i+1]<<8)+e[i+2];a.push(h(n))}return a.join("")}function d(e){var t;var n=e.length;var a=n%3;var i="";var s=[];var o=16383;for(var f=0,u=n-a;f<u;f+=o){s.push(c(e,f,f+o>u?u:f+o))}if(a===1){t=e[n-1];i+=r[t>>2];i+=r[t<<4&63];i+="=="}else if(a===2){t=(e[n-2]<<8)+e[n-1];i+=r[t>>10];i+=r[t>>4&63];i+=r[t<<2&63];i+="="}s.push(i);return s.join("")}},function(e,t){t.read=function(e,t,r,n,a){var i,s;var o=a*8-n-1;var f=(1<<o)-1;var u=f>>1;var l=-7;var h=r?a-1:0;var c=r?-1:1;var d=e[t+h];h+=c;i=d&(1<<-l)-1;d>>=-l;l+=o;for(;l>0;i=i*256+e[t+h],h+=c,l-=8){}s=i&(1<<-l)-1;i>>=-l;l+=n;for(;l>0;s=s*256+e[t+h],h+=c,l-=8){}if(i===0){i=1-u}else if(i===f){return s?NaN:(d?-1:1)*Infinity}else{s=s+Math.pow(2,n);i=i-u}return(d?-1:1)*s*Math.pow(2,i-n)};t.write=function(e,t,r,n,a,i){var s,o,f;var u=i*8-a-1;var l=(1<<u)-1;var h=l>>1;var c=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:i-1;var p=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){o=isNaN(t)?1:0;s=l}else{s=Math.floor(Math.log(t)/Math.LN2);if(t*(f=Math.pow(2,-s))<1){s--;f*=2}if(s+h>=1){t+=c/f}else{t+=c*Math.pow(2,1-h)}if(t*f>=2){s++;f/=2}if(s+h>=l){o=0;s=l}else if(s+h>=1){o=(t*f-1)*Math.pow(2,a);s=s+h}else{o=t*Math.pow(2,h-1)*Math.pow(2,a);s=0}}for(;a>=8;e[r+d]=o&255,d+=p,o/=256,a-=8){}s=s<<a|o;u+=a;for(;u>0;e[r+d]=s&255,d+=p,s/=256,u-=8){}e[r+d-p]|=v*128}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return r.call(e)=="[object Array]"}},function(e,t){var r=e.exports={};var n;var a;function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=i}}catch(e){n=i}try{if(typeof clearTimeout==="function"){a=clearTimeout}else{a=s}}catch(e){a=s}})();function o(e){if(n===setTimeout){return setTimeout(e,0)}if((n===i||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function f(e){if(a===clearTimeout){return clearTimeout(e)}if((a===s||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(e)}try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}var u=[];var l=false;var h;var c=-1;function d(){if(!l||!h){return}l=false;if(h.length){u=h.concat(u)}else{c=-1}if(u.length){p()}}function p(){if(l){return}var e=o(d);l=true;var t=u.length;while(t){h=u;u=[];while(++c<t){if(h){h[c].run()}}c=-1;t=u.length}h=null;l=false;f(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new v(e,t));if(u.length===1&&!l){o(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function y(){}r.on=y;r.addListener=y;r.once=y;r.off=y;r.removeListener=y;r.removeAllListeners=y;r.emit=y;r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t){(function(e){t.fetch=s(e.fetch)&&s(e.ReadableStream);t.blobConstructor=false;try{new Blob([new ArrayBuffer(1)]);t.blobConstructor=true}catch(e){}var r=new e.XMLHttpRequest;r.open("GET",e.XDomainRequest?"/":"https://example.com");function n(e){try{r.responseType=e;return r.responseType===e}catch(e){}return false}var a=typeof e.ArrayBuffer!=="undefined";var i=a&&s(e.ArrayBuffer.prototype.slice);t.arraybuffer=a&&n("arraybuffer");t.msstream=!t.fetch&&i&&n("ms-stream");t.mozchunkedarraybuffer=!t.fetch&&a&&n("moz-chunked-arraybuffer");t.overrideMimeType=s(r.overrideMimeType);t.vbArray=s(e.VBArray);function s(e){return typeof e==="function"}r=null}).call(t,function(){return this}())},function(e,t){if(typeof Object.create==="function"){e.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{e.exports=function e(t,r){t.super_=r;var n=function(){};n.prototype=r.prototype;t.prototype=new n;t.prototype.constructor=t}}},function(e,t,r){(function(e,n,a){var i=r(14);var s=r(15);var o=r(17);var f=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var u=t.IncomingMessage=function(t,r,a){var s=this;o.Readable.call(s);s._mode=a;s.headers={};s.rawHeaders=[];s.trailers={};s.rawTrailers=[];s.on("end",function(){e.nextTick(function(){s.emit("close")})});if(a==="fetch"){s._fetchResponse=r;s.url=r.url;s.statusCode=r.status;s.statusMessage=r.statusText;r.headers.forEach(function(e,t){s.headers[t.toLowerCase()]=e;s.rawHeaders.push(t,e)});var f=r.body.getReader();function u(){f.read().then(function(e){if(s._destroyed)return;if(e.done){s.push(null);return}s.push(new n(e.value));u()})}u()}else{s._xhr=t;s._pos=0;s.url=t.responseURL;s.statusCode=t.status;s.statusMessage=t.statusText;var l=t.getAllResponseHeaders().split(/\r?\n/);l.forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();if(r==="set-cookie"){if(s.headers[r]===undefined){s.headers[r]=[]}s.headers[r].push(t[2])}else if(s.headers[r]!==undefined){s.headers[r]+=", "+t[2]}else{s.headers[r]=t[2]}s.rawHeaders.push(t[1],t[2])}});s._charset="x-user-defined";if(!i.overrideMimeType){var h=s.rawHeaders["mime-type"];if(h){var c=h.match(/;\s*charset=([^;])(;|$)/);if(c){s._charset=c[1].toLowerCase()}}if(!s._charset)s._charset="utf-8"}}};s(u,o.Readable);u.prototype._read=function(){};u.prototype._onXHRProgress=function(){var e=this;var t=e._xhr;var r=null;switch(e._mode){case"text:vbarray":if(t.readyState!==f.DONE)break;try{r=new a.VBArray(t.responseBody).toArray()}catch(e){}if(r!==null){e.push(new n(r));break}case"text":try{r=t.responseText}catch(t){e._mode="text:vbarray";break}if(r.length>e._pos){var i=r.substr(e._pos);if(e._charset==="x-user-defined"){var s=new n(i.length);for(var o=0;o<i.length;o++)s[o]=i.charCodeAt(o)&255;e.push(s)}else{e.push(i,e._charset)}e._pos=r.length}break;case"arraybuffer":if(t.readyState!==f.DONE||!t.response)break;r=t.response;e.push(new n(new Uint8Array(r)));break;case"moz-chunked-arraybuffer":r=t.response;if(t.readyState!==f.LOADING||!r)break;e.push(new n(new Uint8Array(r)));break;case"ms-stream":r=t.response;if(t.readyState!==f.LOADING)break;var u=new a.MSStreamReader;u.onprogress=function(){if(u.result.byteLength>e._pos){e.push(new n(new Uint8Array(u.result.slice(e._pos))));e._pos=u.result.byteLength}};u.onload=function(){e.push(null)};u.readAsArrayBuffer(r);break}if(e._xhr.readyState===f.DONE&&e._mode!=="ms-stream"){e.push(null)}}}).call(t,r(13),r(9).Buffer,function(){return this}())},function(e,t,r){(function(n){var a=function(){try{return r(18)}catch(e){}}();t=e.exports=r(29);t.Stream=a||t;t.Readable=t;t.Writable=r(21);t.Duplex=r(28);t.Transform=r(35);t.PassThrough=r(37);if(!n.browser&&n.env.READABLE_STREAM==="disable"&&a){e.exports=a}}).call(t,r(13))},function(e,t,r){e.exports=i;var n=r(19).EventEmitter;var a=r(15);a(i,n);i.Readable=r(17);i.Writable=r(20);i.Duplex=r(33);i.Transform=r(34);i.PassThrough=r(36);i.Stream=i;function i(){n.call(this)}i.prototype.pipe=function(e,t){var r=this;function a(t){if(e.writable){if(false===e.write(t)&&r.pause){r.pause()}}}r.on("data",a);function i(){if(r.readable&&r.resume){r.resume()}}e.on("drain",i);if(!e._isStdio&&(!t||t.end!==false)){r.on("end",o);r.on("close",f)}var s=false;function o(){if(s)return;s=true;e.end()}function f(){if(s)return;s=true;if(typeof e.destroy==="function")e.destroy()}function u(e){l();if(n.listenerCount(this,"error")===0){throw e}}r.on("error",u);e.on("error",u);function l(){r.removeListener("data",a);e.removeListener("drain",i);r.removeListener("end",o);r.removeListener("close",f);r.removeListener("error",u);e.removeListener("error",u);r.removeListener("end",l);r.removeListener("close",l);e.removeListener("close",l)}r.on("end",l);r.on("close",l);e.on("close",l);e.emit("pipe",r);return e}},function(e,t){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}e.exports=r;r.EventEmitter=r;r.prototype._events=undefined;r.prototype._maxListeners=undefined;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};r.prototype.emit=function(e){var t,r,a,o,f,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||i(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var l=new Error('Uncaught, unspecified "error" event. ('+t+")");l.context=t;throw l}}}r=this._events[e];if(s(r))return false;if(n(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1);r.apply(this,o)}}else if(i(r)){o=Array.prototype.slice.call(arguments,1);u=r.slice();a=u.length;for(f=0;f<a;f++)u[f].apply(this,o)}return true};r.prototype.addListener=function(e,t){var a;if(!n(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,n(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(i(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(i(this._events[e])&&!this._events[e].warned){if(!s(this._maxListeners)){a=this._maxListeners}else{a=r.defaultMaxListeners}if(a&&a>0&&this._events[e].length>a){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=false;function a(){this.removeListener(e,a);if(!r){r=true;t.apply(this,arguments)}}a.listener=t;this.on(e,a);return this};r.prototype.removeListener=function(e,t){var r,a,s,o;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];s=r.length;a=-1;if(r===t||n(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(i(r)){for(o=s;o-- >0;){if(r[o]===t||r[o].listener&&r[o].listener===t){a=o;break}}if(a<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(a,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(n(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};r.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(n(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;else if(t)return t.length}return 0};r.listenerCount=function(e,t){return e.listenerCount(t)};function n(e){return typeof e==="function"}function a(e){return typeof e==="number"}function i(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},function(e,t,r){e.exports=r(21)},function(e,t,r){(function(t,n){"use strict";e.exports=y;var a=r(24);var i=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:a;var s;y.WritableState=p;var o=r(25);o.inherits=r(15);var f={deprecate:r(26)};var u;(function(){try{u=r(18)}catch(e){}finally{if(!u)u=r(19).EventEmitter}})();var l=r(9).Buffer;var h=r(27);o.inherits(y,u);function c(){}function d(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function p(e,t){s=s||r(28);e=e||{};this.objectMode=!!e.objectMode;if(t instanceof s)this.objectMode=this.objectMode||!!e.writableObjectMode;var n=e.highWaterMark;var a=this.objectMode?16:16*1024;this.highWaterMark=n||n===0?n:a;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var i=e.decodeStrings===false;this.decodeStrings=!i;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){x(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new O(this)}p.prototype.getBuffer=function e(){var t=this.bufferedRequest;var r=[];while(t){r.push(t);t=t.next}return r};(function(){try{Object.defineProperty(p.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.")})}catch(e){}})();var v;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){v=Function.prototype[Symbol.hasInstance];Object.defineProperty(y,Symbol.hasInstance,{value:function(e){if(v.call(this,e))return true;return e&&e._writableState instanceof p}})}else{v=function(e){return e instanceof this}}function y(e){s=s||r(28);if(!v.call(y,this)&&!(this instanceof s)){return new y(e)}this._writableState=new p(e,this);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev}u.call(this)}y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function m(e,t){var r=new Error("write after end");e.emit("error",r);a(t,r)}function g(e,t,r,n){var i=true;var s=false;if(r===null){s=new TypeError("May not write null values to stream")}else if(!l.isBuffer(r)&&typeof r!=="string"&&r!==undefined&&!t.objectMode){s=new TypeError("Invalid non-string/buffer chunk")}if(s){e.emit("error",s);a(n,s);i=false}return i}y.prototype.write=function(e,t,r){var n=this._writableState;var a=false;if(typeof t==="function"){r=t;t=null}if(l.isBuffer(e))t="buffer";else if(!t)t=n.defaultEncoding;if(typeof r!=="function")r=c;if(n.ended)m(this,r);else if(g(this,n,e,r)){n.pendingcb++;a=w(this,n,e,t,r)}return a};y.prototype.cork=function(){var e=this._writableState;e.corked++};y.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.bufferedRequest)k(this,e)}};y.prototype.setDefaultEncoding=function e(t){if(typeof t==="string")t=t.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);this._writableState.defaultEncoding=t;return this};function b(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=h.from(t,r)}return t}function w(e,t,r,n,a){r=b(t,r,n);if(l.isBuffer(r))n="buffer";var i=t.objectMode?1:r.length;t.length+=i;var s=t.length<t.highWaterMark;if(!s)t.needDrain=true;if(t.writing||t.corked){var o=t.lastBufferedRequest;t.lastBufferedRequest=new d(r,n,a);if(o){o.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{_(e,t,false,i,r,n,a)}return s}function _(e,t,r,n,a,i,s){t.writelen=n;t.writecb=s;t.writing=true;t.sync=true;if(r)e._writev(a,t.onwrite);else e._write(a,i,t.onwrite);t.sync=false}function C(e,t,r,n,i){--t.pendingcb;if(r)a(i,n);else i(n);e._writableState.errorEmitted=true;e.emit("error",n)}function A(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function x(e,t){var r=e._writableState;var n=r.sync;var a=r.writecb;A(r);if(t)C(e,r,n,t,a);else{var s=E(r);if(!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){k(e,r)}if(n){i(S,e,r,s,a)}else{S(e,r,s,a)}}}function S(e,t,r,n){if(!r)I(e,t);t.pendingcb--;n();L(e,t)}function I(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function k(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount;var a=new Array(n);var i=t.corkedRequestsFree;i.entry=r;var s=0;while(r){a[s]=r;r=r.next;s+=1}_(e,t,true,t.length,a,"",i.finish);t.pendingcb++;t.lastBufferedRequest=null;if(i.next){t.corkedRequestsFree=i.next;i.next=null}else{t.corkedRequestsFree=new O(t)}}else{while(r){var o=r.chunk;var f=r.encoding;var u=r.callback;var l=t.objectMode?1:o.length;_(e,t,false,l,o,f,u);r=r.next;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequestCount=0;t.bufferedRequest=r;t.bufferProcessing=false}y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))};y.prototype._writev=null;y.prototype.end=function(e,t,r){var n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(n.corked){n.corked=1;this.uncork()}if(!n.ending&&!n.finished)T(this,n,r)};function E(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function R(e,t){if(!t.prefinished){t.prefinished=true;e.emit("prefinish")}}function L(e,t){var r=E(t);if(r){if(t.pendingcb===0){R(e,t);t.finished=true;e.emit("finish")}else{R(e,t)}}return r}function T(e,t,r){t.ending=true;L(e,t);if(r){if(t.finished)a(r);else e.once("finish",r)}t.ended=true;e.writable=false}function O(e){var t=this;this.next=null;this.entry=null;this.finish=function(r){var n=t.entry;t.entry=null;while(n){var a=n.callback;e.pendingcb--;a(r);n=n.next}if(e.corkedRequestsFree){e.corkedRequestsFree.next=t}else{e.corkedRequestsFree=t;
}}}}).call(t,r(13),r(22).setImmediate)},function(e,t,r){var n=Function.prototype.apply;t.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)};t.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){if(e){e.close()}};function a(e,t){this._id=e;this._clearFn=t}a.prototype.unref=a.prototype.ref=function(){};a.prototype.close=function(){this._clearFn.call(window,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout(function t(){if(e._onTimeout)e._onTimeout()},t)}};r(23);t.setImmediate=setImmediate;t.clearImmediate=clearImmediate},function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate){return}var n=1;var a={};var i=false;var s=e.document;var o;function f(e){if(typeof e!=="function"){e=new Function(""+e)}var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++){t[r]=arguments[r+1]}var i={callback:e,args:t};a[n]=i;o(n);return n++}function u(e){delete a[e]}function l(e){var t=e.callback;var n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n);break}}function h(e){if(i){setTimeout(h,0,e)}else{var t=a[e];if(t){i=true;try{l(t)}finally{u(e);i=false}}}}function c(){o=function(e){t.nextTick(function(){h(e)})}}function d(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function p(){var t="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===e&&typeof r.data==="string"&&r.data.indexOf(t)===0){h(+r.data.slice(t.length))}};if(e.addEventListener){e.addEventListener("message",r,false)}else{e.attachEvent("onmessage",r)}o=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;h(t)};o=function(t){e.port2.postMessage(t)}}function y(){var e=s.documentElement;o=function(t){var r=s.createElement("script");r.onreadystatechange=function(){h(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function m(){o=function(e){setTimeout(h,0,e)}}var g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e;if({}.toString.call(e.process)==="[object process]"){c()}else if(d()){p()}else if(e.MessageChannel){v()}else if(s&&"onreadystatechange"in s.createElement("script")){y()}else{m()}g.setImmediate=f;g.clearImmediate=u})(typeof self==="undefined"?typeof e==="undefined"?this:e:self)}).call(t,function(){return this}(),r(13))},function(e,t,r){(function(t){"use strict";if(!t.version||t.version.indexOf("v0.")===0||t.version.indexOf("v1.")===0&&t.version.indexOf("v1.8.")!==0){e.exports=r}else{e.exports=t.nextTick}function r(e,r,n,a){if(typeof e!=="function"){throw new TypeError('"callback" argument must be a function')}var i=arguments.length;var s,o;switch(i){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function t(){e.call(null,r)});case 3:return t.nextTick(function t(){e.call(null,r,n)});case 4:return t.nextTick(function t(){e.call(null,r,n,a)});default:s=new Array(i-1);o=0;while(o<s.length){s[o++]=arguments[o]}return t.nextTick(function t(){e.apply(null,s)})}}}).call(t,r(13))},function(e,t,r){(function(e){function r(e){if(Array.isArray){return Array.isArray(e)}return y(e)==="[object Array]"}t.isArray=r;function n(e){return typeof e==="boolean"}t.isBoolean=n;function a(e){return e===null}t.isNull=a;function i(e){return e==null}t.isNullOrUndefined=i;function s(e){return typeof e==="number"}t.isNumber=s;function o(e){return typeof e==="string"}t.isString=o;function f(e){return typeof e==="symbol"}t.isSymbol=f;function u(e){return e===void 0}t.isUndefined=u;function l(e){return y(e)==="[object RegExp]"}t.isRegExp=l;function h(e){return typeof e==="object"&&e!==null}t.isObject=h;function c(e){return y(e)==="[object Date]"}t.isDate=c;function d(e){return y(e)==="[object Error]"||e instanceof Error}t.isError=d;function p(e){return typeof e==="function"}t.isFunction=p;function v(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}t.isPrimitive=v;t.isBuffer=e.isBuffer;function y(e){return Object.prototype.toString.call(e)}}).call(t,r(9).Buffer)},function(e,t){(function(t){e.exports=r;function r(e,t){if(n("noDeprecation")){return e}var r=false;function a(){if(!r){if(n("throwDeprecation")){throw new Error(t)}else if(n("traceDeprecation")){console.trace(t)}else{console.warn(t)}r=true}return e.apply(this,arguments)}return a}function n(e){try{if(!t.localStorage)return false}catch(e){return false}var r=t.localStorage[e];if(null==r)return false;return String(r).toLowerCase()==="true"}}).call(t,function(){return this}())},function(e,t,r){(function(e){"use strict";var n=r(9);var a=n.Buffer;var i=n.SlowBuffer;var s=n.kMaxLength||2147483647;t.alloc=function e(t,r,n){if(typeof a.alloc==="function"){return a.alloc(t,r,n)}if(typeof n==="number"){throw new TypeError("encoding must not be number")}if(typeof t!=="number"){throw new TypeError("size must be a number")}if(t>s){throw new RangeError("size is too large")}var i=n;var o=r;if(o===undefined){i=undefined;o=0}var f=new a(t);if(typeof o==="string"){var u=new a(o,i);var l=u.length;var h=-1;while(++h<t){f[h]=u[h%l]}}else{f.fill(o)}return f};t.allocUnsafe=function e(t){if(typeof a.allocUnsafe==="function"){return a.allocUnsafe(t)}if(typeof t!=="number"){throw new TypeError("size must be a number")}if(t>s){throw new RangeError("size is too large")}return new a(t)};t.from=function t(r,n,i){if(typeof a.from==="function"&&(!e.Uint8Array||Uint8Array.from!==a.from)){return a.from(r,n,i)}if(typeof r==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof r==="string"){return new a(r,n)}if(typeof ArrayBuffer!=="undefined"&&r instanceof ArrayBuffer){var s=n;if(arguments.length===1){return new a(r)}if(typeof s==="undefined"){s=0}var o=i;if(typeof o==="undefined"){o=r.byteLength-s}if(s>=r.byteLength){throw new RangeError("'offset' is out of bounds")}if(o>r.byteLength-s){throw new RangeError("'length' is out of bounds")}return new a(r.slice(s,s+o))}if(a.isBuffer(r)){var f=new a(r.length);r.copy(f,0,0,r.length);return f}if(r){if(Array.isArray(r)||typeof ArrayBuffer!=="undefined"&&r.buffer instanceof ArrayBuffer||"length"in r){return new a(r)}if(r.type==="Buffer"&&Array.isArray(r.data)){return new a(r.data)}}throw new TypeError("First argument must be a string, Buffer, "+"ArrayBuffer, Array, or array-like object.")};t.allocUnsafeSlow=function e(t){if(typeof a.allocUnsafeSlow==="function"){return a.allocUnsafeSlow(t)}if(typeof t!=="number"){throw new TypeError("size must be a number")}if(t>=s){throw new RangeError("size is too large")}return new i(t)}}).call(t,function(){return this}())},function(e,t,r){"use strict";var n=Object.keys||function(e){var t=[];for(var r in e){t.push(r)}return t};e.exports=h;var a=r(24);var i=r(25);i.inherits=r(15);var s=r(29);var o=r(21);i.inherits(h,s);var f=n(o.prototype);for(var u=0;u<f.length;u++){var l=f[u];if(!h.prototype[l])h.prototype[l]=o.prototype[l]}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e);o.call(this,e);if(e&&e.readable===false)this.readable=false;if(e&&e.writable===false)this.writable=false;this.allowHalfOpen=true;if(e&&e.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",c)}function c(){if(this.allowHalfOpen||this._writableState.ended)return;a(d,this)}function d(e){e.end()}function p(e,t){for(var r=0,n=e.length;r<n;r++){t(e[r],r)}}},function(e,t,r){(function(t){"use strict";e.exports=g;var n=r(24);var a=r(12);var i;g.ReadableState=m;var s=r(19).EventEmitter;var o=function(e,t){return e.listeners(t).length};var f;(function(){try{f=r(18)}catch(e){}finally{if(!f)f=r(19).EventEmitter}})();var u=r(9).Buffer;var l=r(27);var h=r(25);h.inherits=r(15);var c=r(30);var d=void 0;if(c&&c.debuglog){d=c.debuglog("stream")}else{d=function(){}}var p=r(31);var v;h.inherits(g,f);function y(e,t,r){if(typeof e.prependListener==="function"){return e.prependListener(t,r)}else{if(!e._events||!e._events[t])e.on(t,r);else if(a(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}}function m(e,t){i=i||r(28);e=e||{};this.objectMode=!!e.objectMode;if(t instanceof i)this.objectMode=this.objectMode||!!e.readableObjectMode;var n=e.highWaterMark;var a=this.objectMode?16:16*1024;this.highWaterMark=n||n===0?n:a;this.highWaterMark=~~this.highWaterMark;this.buffer=new p;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!v)v=r(32).StringDecoder;this.decoder=new v(e.encoding);this.encoding=e.encoding}}function g(e){i=i||r(28);if(!(this instanceof g))return new g(e);this._readableState=new m(e,this);this.readable=true;if(e&&typeof e.read==="function")this._read=e.read;f.call(this)}g.prototype.push=function(e,t){var r=this._readableState;if(!r.objectMode&&typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=l.from(e,t);t=""}}return b(this,r,e,t,false)};g.prototype.unshift=function(e){var t=this._readableState;return b(this,t,e,"",true)};g.prototype.isPaused=function(){return this._readableState.flowing===false};function b(e,t,r,n,a){var i=x(t,r);if(i){e.emit("error",i)}else if(r===null){t.reading=false;S(e,t)}else if(t.objectMode||r&&r.length>0){if(t.ended&&!a){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&a){var o=new Error("stream.unshift() after end event");e.emit("error",o)}else{var f;if(t.decoder&&!a&&!n){r=t.decoder.write(r);f=!t.objectMode&&r.length===0}if(!a)t.reading=false;if(!f){if(t.flowing&&t.length===0&&!t.sync){e.emit("data",r);e.read(0)}else{t.length+=t.objectMode?1:r.length;if(a)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)I(e)}}E(e,t)}}else if(!a){t.reading=false}return w(t)}function w(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}g.prototype.setEncoding=function(e){if(!v)v=r(32).StringDecoder;this._readableState.decoder=new v(e);this._readableState.encoding=e;return this};var _=8388608;function C(e){if(e>=_){e=_}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function A(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=C(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}g.prototype.read=function(e){d("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended)){d("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)z(this);else I(this);return null}e=A(e,t);if(e===0&&t.ended){if(t.length===0)z(this);return null}var n=t.needReadable;d("need readable",n);if(t.length===0||t.length-e<t.highWaterMark){n=true;d("length less than watermark",n)}if(t.ended||t.reading){n=false;d("reading or ended",n)}else if(n){d("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=A(r,t)}var a;if(e>0)a=M(e,t);else a=null;if(a===null){t.needReadable=true;e=0}else{t.length-=e}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)z(this)}if(a!==null)this.emit("data",a);return a};function x(e,t){var r=null;if(!u.isBuffer(t)&&typeof t!=="string"&&t!==null&&t!==undefined&&!e.objectMode){r=new TypeError("Invalid non-string/buffer chunk")}return r}function S(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;I(e)}function I(e){var t=e._readableState;t.needReadable=false;if(!t.emittedReadable){d("emitReadable",t.flowing);t.emittedReadable=true;if(t.sync)n(k,e);else k(e)}}function k(e){d("emit readable");e.emit("readable");P(e)}function E(e,t){if(!t.readingMore){t.readingMore=true;n(R,e,t)}}function R(e,t){var r=t.length;while(!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark){d("maybeReadMore read 0");e.read(0);if(r===t.length)break;else r=t.length}t.readingMore=false}g.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))};g.prototype.pipe=function(e,r){var a=this;var i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e);break}i.pipesCount+=1;d("pipe count=%d opts=%j",i.pipesCount,r);var s=(!r||r.end!==false)&&e!==t.stdout&&e!==t.stderr;var f=s?l:p;if(i.endEmitted)n(f);else a.once("end",f);e.on("unpipe",u);function u(e){d("onunpipe");if(e===a){p()}}function l(){d("onend");e.end()}var h=L(a);e.on("drain",h);var c=false;function p(){d("cleanup");e.removeListener("close",b);e.removeListener("finish",w);e.removeListener("drain",h);e.removeListener("error",g);e.removeListener("unpipe",u);a.removeListener("end",l);a.removeListener("end",p);a.removeListener("data",m);c=true;if(i.awaitDrain&&(!e._writableState||e._writableState.needDrain))h()}var v=false;a.on("data",m);function m(t){d("ondata");v=false;var r=e.write(t);if(false===r&&!v){if((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&q(i.pipes,e)!==-1)&&!c){d("false write response, pause",a._readableState.awaitDrain);a._readableState.awaitDrain++;v=true}a.pause()}}function g(t){d("onerror",t);_();e.removeListener("error",g);if(o(e,"error")===0)e.emit("error",t)}y(e,"error",g);function b(){e.removeListener("finish",w);_()}e.once("close",b);function w(){d("onfinish");e.removeListener("close",b);_()}e.once("finish",w);function _(){d("unpipe");a.unpipe(e)}e.emit("pipe",a);if(!i.flowing){d("pipe resume");a.resume()}return e};function L(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&o(e,"data")){t.flowing=true;P(e)}}}g.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this);return this}if(!e){var r=t.pipes;var n=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var a=0;a<n;a++){r[a].emit("unpipe",this)}return this}var i=q(t.pipes,e);if(i===-1)return this;t.pipes.splice(i,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this);return this};g.prototype.on=function(e,t){var r=f.prototype.on.call(this,e,t);if(e==="data"){if(this._readableState.flowing!==false)this.resume()}else if(e==="readable"){var a=this._readableState;if(!a.endEmitted&&!a.readableListening){a.readableListening=a.needReadable=true;a.emittedReadable=false;if(!a.reading){n(T,this)}else if(a.length){I(this,a)}}}return r};g.prototype.addListener=g.prototype.on;function T(e){d("readable nexttick read 0");e.read(0)}g.prototype.resume=function(){var e=this._readableState;if(!e.flowing){d("resume");e.flowing=true;O(this,e)}return this};function O(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;n(B,e,t)}}function B(e,t){if(!t.reading){d("resume read 0");e.read(0)}t.resumeScheduled=false;t.awaitDrain=0;e.emit("resume");P(e);if(t.flowing&&!t.reading)e.read(0)}g.prototype.pause=function(){d("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){d("pause");this._readableState.flowing=false;this.emit("pause")}return this};function P(e){var t=e._readableState;d("flow",t.flowing);while(t.flowing&&e.read()!==null){}}g.prototype.wrap=function(e){var t=this._readableState;var r=false;var n=this;e.on("end",function(){d("wrapped end");if(t.decoder&&!t.ended){var e=t.decoder.end();if(e&&e.length)n.push(e)}n.push(null)});e.on("data",function(a){d("wrapped data");if(t.decoder)a=t.decoder.write(a);if(t.objectMode&&(a===null||a===undefined))return;else if(!t.objectMode&&(!a||!a.length))return;var i=n.push(a);if(!i){r=true;e.pause()}});for(var a in e){if(this[a]===undefined&&typeof e[a]==="function"){this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a)}}var i=["error","close","destroy","pause","resume"];D(i,function(t){e.on(t,n.emit.bind(n,t))});n._read=function(t){d("wrapped _read",t);if(r){r=false;e.resume()}};return n};g._fromList=M;function M(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.head.data;else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=U(e,t.buffer,t.decoder)}return r}function U(e,t,r){var n;if(e<t.head.data.length){n=t.head.data.slice(0,e);t.head.data=t.head.data.slice(e)}else if(e===t.head.data.length){n=t.shift()}else{n=r?j(e,t):N(e,t)}return n}function j(e,t){var r=t.head;var n=1;var a=r.data;e-=a.length;while(r=r.next){var i=r.data;var s=e>i.length?i.length:e;if(s===i.length)a+=i;else a+=i.slice(0,e);e-=s;if(e===0){if(s===i.length){++n;if(r.next)t.head=r.next;else t.head=t.tail=null}else{t.head=r;r.data=i.slice(s)}break}++n}t.length-=n;return a}function N(e,t){var r=l.allocUnsafe(e);var n=t.head;var a=1;n.data.copy(r);e-=n.data.length;while(n=n.next){var i=n.data;var s=e>i.length?i.length:e;i.copy(r,r.length-e,0,s);e-=s;if(e===0){if(s===i.length){++a;if(n.next)t.head=n.next;else t.head=t.tail=null}else{t.head=n;n.data=i.slice(s)}break}++a}t.length-=a;return r}function z(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!t.endEmitted){t.ended=true;n(Z,t,e)}}function Z(e,t){if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end")}}function D(e,t){for(var r=0,n=e.length;r<n;r++){t(e[r],r)}}function q(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t)return r}return-1}}).call(t,r(13))},function(e,t){},function(e,t,r){"use strict";var n=r(9).Buffer;var a=r(27);e.exports=i;function i(){this.head=null;this.tail=null;this.length=0}i.prototype.push=function(e){var t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length};i.prototype.unshift=function(e){var t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length};i.prototype.shift=function(){if(this.length===0)return;var e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e};i.prototype.clear=function(){this.head=this.tail=null;this.length=0};i.prototype.join=function(e){if(this.length===0)return"";var t=this.head;var r=""+t.data;while(t=t.next){r+=e+t.data}return r};i.prototype.concat=function(e){if(this.length===0)return a.alloc(0);if(this.length===1)return this.head.data;var t=a.allocUnsafe(e>>>0);var r=this.head;var n=0;while(r){r.data.copy(t,n);n+=r.data.length;r=r.next}return t}},function(e,t,r){var n=r(9).Buffer;var a=n.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function i(e){if(e&&!a(e)){throw new Error("Unknown encoding: "+e)}}var s=t.StringDecoder=function(e){this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,"");i(e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=u;break;default:this.write=o;return}this.charBuffer=new n(6);this.charReceived=0;this.charLength=0};s.prototype.write=function(e){var t="";while(this.charLength){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;e.copy(this.charBuffer,this.charReceived,0,r);this.charReceived+=r;if(this.charReceived<this.charLength){return""}e=e.slice(r,e.length);t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319){this.charLength+=this.surrogateSize;t="";continue}this.charReceived=this.charLength=0;if(e.length===0){return t}break}this.detectIncompleteChar(e);var a=e.length;if(this.charLength){e.copy(this.charBuffer,0,e.length-this.charReceived,a);a-=this.charReceived}t+=e.toString(this.encoding,0,a);var a=t.length-1;var n=t.charCodeAt(a);if(n>=55296&&n<=56319){var i=this.surrogateSize;this.charLength+=i;this.charReceived+=i;this.charBuffer.copy(this.charBuffer,i,0,i);e.copy(this.charBuffer,0,0,i);return t.substring(0,a)}return t};s.prototype.detectIncompleteChar=function(e){var t=e.length>=3?3:e.length;for(;t>0;t--){var r=e[e.length-t];if(t==1&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t};s.prototype.end=function(e){var t="";if(e&&e.length)t=this.write(e);if(this.charReceived){var r=this.charReceived;var n=this.charBuffer;var a=this.encoding;t+=n.slice(0,r).toString(a)}return t};function o(e){return e.toString(this.encoding)}function f(e){this.charReceived=e.length%2;this.charLength=this.charReceived?2:0}function u(e){this.charReceived=e.length%3;this.charLength=this.charReceived?3:0}},function(e,t,r){e.exports=r(28)},function(e,t,r){e.exports=r(35)},function(e,t,r){"use strict";e.exports=o;var n=r(28);var a=r(25);a.inherits=r(15);a.inherits(o,n);function i(e){this.afterTransform=function(t,r){return s(e,t,r)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null}function s(e,t,r){var n=e._transformState;n.transforming=false;var a=n.writecb;if(!a)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null;n.writecb=null;if(r!==null&&r!==undefined)e.push(r);a(t);var i=e._readableState;i.reading=false;if(i.needReadable||i.length<i.highWaterMark){e._read(i.highWaterMark)}}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e);this._transformState=new i(this);var t=this;this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(e,r){f(t,e,r)});else f(t)})}o.prototype.push=function(e,t){this._transformState.needTransform=false;return n.prototype.push.call(this,e,t)};o.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")};o.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r;n.writechunk=e;n.writeencoding=t;if(!n.transforming){var a=this._readableState;if(n.needTransform||a.needReadable||a.length<a.highWaterMark)this._read(a.highWaterMark)}};o.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&t.writecb&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};function f(e,t,r){if(t)return e.emit("error",t);if(r!==null&&r!==undefined)e.push(r);var n=e._writableState;var a=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(a.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}},function(e,t,r){e.exports=r(37)},function(e,t,r){"use strict";e.exports=i;var n=r(35);var a=r(25);a.inherits=r(15);a.inherits(i,n);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){var n=r(9).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(e.byteOffset===0&&e.byteLength===e.buffer.byteLength){return e.buffer}else if(typeof e.buffer.slice==="function"){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}if(n.isBuffer(e)){var t=new Uint8Array(e.length);var r=e.length;for(var a=0;a<r;a++){t[a]=e[a]}return t.buffer}else{throw new Error("Argument must be a Buffer")}}},function(e,t){e.exports=n;var r=Object.prototype.hasOwnProperty;function n(){var e={};for(var t=0;t<arguments.length;t++){var n=arguments[t];for(var a in n){if(r.call(n,a)){e[a]=n[a]}}}return e}},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,r){"use strict";var n=r(42);var a=r(44);t.parse=_;t.resolve=A;t.resolveObject=x;t.format=C;t.Url=i;function i(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],l=["{","}","|","\\","^","`"].concat(u),h=["'"].concat(l),c=["%","/","?",";","#"].concat(h),d=["/","?","#"],p=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:true,"javascript:":true},g={javascript:true,"javascript:":true},b={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},w=r(45);function _(e,t,r){if(e&&a.isObject(e)&&e instanceof i)return e;var n=new i;n.parse(e,t,r);return n}i.prototype.parse=function(e,t,r){if(!a.isString(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var i=e.indexOf("?"),o=i!==-1&&i<e.indexOf("#")?"?":"#",u=e.split(o),l=/\\/g;u[0]=u[0].replace(l,"/");e=u.join(o);var _=e;_=_.trim();if(!r&&e.split("#").length===1){var C=f.exec(_);if(C){this.path=_;this.href=_;this.pathname=C[1];if(C[2]){this.search=C[2];if(t){this.query=w.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(t){this.search="";this.query={}}return this}}var A=s.exec(_);if(A){A=A[0];var x=A.toLowerCase();this.protocol=x;_=_.substr(A.length)}if(r||A||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var S=_.substr(0,2)==="//";if(S&&!(A&&g[A])){_=_.substr(2);this.slashes=true}}if(!g[A]&&(S||A&&!b[A])){var I=-1;for(var k=0;k<d.length;k++){var E=_.indexOf(d[k]);if(E!==-1&&(I===-1||E<I))I=E}var R,L;if(I===-1){L=_.lastIndexOf("@")}else{L=_.lastIndexOf("@",I)}if(L!==-1){R=_.slice(0,L);_=_.slice(L+1);this.auth=decodeURIComponent(R)}I=-1;for(var k=0;k<c.length;k++){var E=_.indexOf(c[k]);if(E!==-1&&(I===-1||E<I))I=E}if(I===-1)I=_.length;this.host=_.slice(0,I);_=_.slice(I);this.parseHost();this.hostname=this.hostname||"";var T=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!T){var O=this.hostname.split(/\./);for(var k=0,B=O.length;k<B;k++){var P=O[k];if(!P)continue;if(!P.match(v)){var M="";for(var U=0,j=P.length;U<j;U++){if(P.charCodeAt(U)>127){M+="x"}else{M+=P[U]}}if(!M.match(v)){var N=O.slice(0,k);var z=O.slice(k+1);var Z=P.match(y);if(Z){N.push(Z[1]);z.unshift(Z[2])}if(z.length){_="/"+z.join(".")+_}this.hostname=N.join(".");break}}}}if(this.hostname.length>p){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!T){this.hostname=n.toASCII(this.hostname)}var D=this.port?":"+this.port:"";var q=this.hostname||"";this.host=q+D;this.href+=this.host;if(T){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(_[0]!=="/"){_="/"+_}}}if(!m[x]){for(var k=0,B=h.length;k<B;k++){var F=h[k];if(_.indexOf(F)===-1)continue;var H=encodeURIComponent(F);if(H===F){H=escape(F)}_=_.split(F).join(H)}}var Y=_.indexOf("#");if(Y!==-1){this.hash=_.substr(Y);_=_.slice(0,Y)}var W=_.indexOf("?");if(W!==-1){this.search=_.substr(W);this.query=_.substr(W+1);if(t){this.query=w.parse(this.query)}_=_.slice(0,W)}else if(t){this.search="";this.query={}}if(_)this.pathname=_;if(b[x]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var D=this.pathname||"";var V=this.search||"";this.path=D+V}this.href=this.format();return this};function C(e){if(a.isString(e))e=_(e);if(!(e instanceof i))return i.prototype.format.call(e);return e.format()}i.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=false,s="";if(this.host){i=e+this.host}else if(this.hostname){i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){i+=":"+this.port}}if(this.query&&a.isObject(this.query)&&Object.keys(this.query).length){s=w.stringify(this.query)}var o=this.search||s&&"?"+s||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||b[t])&&i!==false){i="//"+(i||"");if(r&&r.charAt(0)!=="/")r="/"+r}else if(!i){i=""}if(n&&n.charAt(0)!=="#")n="#"+n;if(o&&o.charAt(0)!=="?")o="?"+o;r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)});o=o.replace("#","%23");return t+i+r+o+n};function A(e,t){return _(e,false,true).resolve(t)}i.prototype.resolve=function(e){return this.resolveObject(_(e,false,true)).format()};function x(e,t){if(!e)return t;return _(e,false,true).resolveObject(t)}i.prototype.resolveObject=function(e){if(a.isString(e)){var t=new i;t.parse(e,false,true);e=t}var r=new i;var n=Object.keys(this);for(var s=0;s<n.length;s++){var o=n[s];r[o]=this[o]}r.hash=e.hash;if(e.href===""){r.href=r.format();return r}if(e.slashes&&!e.protocol){var f=Object.keys(e);for(var u=0;u<f.length;u++){var l=f[u];if(l!=="protocol")r[l]=e[l]}if(b[r.protocol]&&r.hostname&&!r.pathname){r.path=r.pathname="/"}r.href=r.format();return r}if(e.protocol&&e.protocol!==r.protocol){if(!b[e.protocol]){var h=Object.keys(e);for(var c=0;c<h.length;c++){var d=h[c];r[d]=e[d]}r.href=r.format();return r}r.protocol=e.protocol;if(!e.host&&!g[e.protocol]){var p=(e.pathname||"").split("/");while(p.length&&!(e.host=p.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(p[0]!=="")p.unshift("");if(p.length<2)p.unshift("");r.pathname=p.join("/")}else{r.pathname=e.pathname}r.search=e.search;r.query=e.query;r.host=e.host||"";r.auth=e.auth;r.hostname=e.hostname||e.host;r.port=e.port;if(r.pathname||r.search){var v=r.pathname||"";var y=r.search||"";r.path=v+y}r.slashes=r.slashes||e.slashes;r.href=r.format();return r}var m=r.pathname&&r.pathname.charAt(0)==="/",w=e.host||e.pathname&&e.pathname.charAt(0)==="/",_=w||m||r.host&&e.pathname,C=_,A=r.pathname&&r.pathname.split("/")||[],p=e.pathname&&e.pathname.split("/")||[],x=r.protocol&&!b[r.protocol];if(x){r.hostname="";r.port=null;if(r.host){if(A[0]==="")A[0]=r.host;else A.unshift(r.host)}r.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){
if(p[0]==="")p[0]=e.host;else p.unshift(e.host)}e.host=null}_=_&&(p[0]===""||A[0]==="")}if(w){r.host=e.host||e.host===""?e.host:r.host;r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname;r.search=e.search;r.query=e.query;A=p}else if(p.length){if(!A)A=[];A.pop();A=A.concat(p);r.search=e.search;r.query=e.query}else if(!a.isNullOrUndefined(e.search)){if(x){r.hostname=r.host=A.shift();var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(S){r.auth=S.shift();r.host=r.hostname=S.shift()}}r.search=e.search;r.query=e.query;if(!a.isNull(r.pathname)||!a.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.href=r.format();return r}if(!A.length){r.pathname=null;if(r.search){r.path="/"+r.search}else{r.path=null}r.href=r.format();return r}var I=A.slice(-1)[0];var k=(r.host||e.host||A.length>1)&&(I==="."||I==="..")||I==="";var E=0;for(var R=A.length;R>=0;R--){I=A[R];if(I==="."){A.splice(R,1)}else if(I===".."){A.splice(R,1);E++}else if(E){A.splice(R,1);E--}}if(!_&&!C){for(;E--;E){A.unshift("..")}}if(_&&A[0]!==""&&(!A[0]||A[0].charAt(0)!=="/")){A.unshift("")}if(k&&A.join("/").substr(-1)!=="/"){A.push("")}var L=A[0]===""||A[0]&&A[0].charAt(0)==="/";if(x){r.hostname=r.host=L?"":A.length?A.shift():"";var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(S){r.auth=S.shift();r.host=r.hostname=S.shift()}}_=_||r.host&&A.length;if(_&&!L){A.unshift("")}if(!A.length){r.pathname=null;r.path=null}else{r.pathname=A.join("/")}if(!a.isNull(r.pathname)||!a.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.auth=e.auth||r.auth;r.slashes=r.slashes||e.slashes;r.href=r.format();return r};i.prototype.parseHost=function(){var e=this.host;var t=o.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e}},function(e,t,r){var n;(function(e,a){(function(i){var s=typeof t=="object"&&t&&!t.nodeType&&t;var o=typeof e=="object"&&e&&!e.nodeType&&e;var f=typeof a=="object"&&a;if(f.global===f||f.window===f||f.self===f){i=f}var u,l=2147483647,h=36,c=1,d=26,p=38,v=700,y=72,m=128,g="-",b=/^xn--/,w=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=h-c,x=Math.floor,S=String.fromCharCode,I;function k(e){throw RangeError(C[e])}function E(e,t){var r=e.length;var n=[];while(r--){n[r]=t(e[r])}return n}function R(e,t){var r=e.split("@");var n="";if(r.length>1){n=r[0]+"@";e=r[1]}e=e.replace(_,".");var a=e.split(".");var i=E(a,t).join(".");return n+i}function L(e){var t=[],r=0,n=e.length,a,i;while(r<n){a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){i=e.charCodeAt(r++);if((i&64512)==56320){t.push(((a&1023)<<10)+(i&1023)+65536)}else{t.push(a);r--}}else{t.push(a)}}return t}function T(e){return E(e,function(e){var t="";if(e>65535){e-=65536;t+=S(e>>>10&1023|55296);e=56320|e&1023}t+=S(e);return t}).join("")}function O(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return h}function B(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function P(e,t,r){var n=0;e=r?x(e/v):e>>1;e+=x(e/t);for(;e>A*d>>1;n+=h){e=x(e/A)}return x(n+(A+1)*e/(e+p))}function M(e){var t=[],r=e.length,n,a=0,i=m,s=y,o,f,u,p,v,b,w,_,C;o=e.lastIndexOf(g);if(o<0){o=0}for(f=0;f<o;++f){if(e.charCodeAt(f)>=128){k("not-basic")}t.push(e.charCodeAt(f))}for(u=o>0?o+1:0;u<r;){for(p=a,v=1,b=h;;b+=h){if(u>=r){k("invalid-input")}w=O(e.charCodeAt(u++));if(w>=h||w>x((l-a)/v)){k("overflow")}a+=w*v;_=b<=s?c:b>=s+d?d:b-s;if(w<_){break}C=h-_;if(v>x(l/C)){k("overflow")}v*=C}n=t.length+1;s=P(a-p,n,p==0);if(x(a/n)>l-i){k("overflow")}i+=x(a/n);a%=n;t.splice(a++,0,i)}return T(t)}function U(e){var t,r,n,a,i,s,o,f,u,p,v,b=[],w,_,C,A;e=L(e);w=e.length;t=m;r=0;i=y;for(s=0;s<w;++s){v=e[s];if(v<128){b.push(S(v))}}n=a=b.length;if(a){b.push(g)}while(n<w){for(o=l,s=0;s<w;++s){v=e[s];if(v>=t&&v<o){o=v}}_=n+1;if(o-t>x((l-r)/_)){k("overflow")}r+=(o-t)*_;t=o;for(s=0;s<w;++s){v=e[s];if(v<t&&++r>l){k("overflow")}if(v==t){for(f=r,u=h;;u+=h){p=u<=i?c:u>=i+d?d:u-i;if(f<p){break}A=f-p;C=h-p;b.push(S(B(p+A%C,0)));f=x(A/C)}b.push(S(B(f,0)));i=P(r,_,n==a);r=0;++n}}++r;++t}return b.join("")}function j(e){return R(e,function(e){return b.test(e)?M(e.slice(4).toLowerCase()):e})}function N(e){return R(e,function(e){return w.test(e)?"xn--"+U(e):e})}u={version:"1.3.2",ucs2:{decode:L,encode:T},decode:M,encode:U,toASCII:N,toUnicode:j};if(true){!(n=function(){return u}.call(t,r,t,e),n!==undefined&&(e.exports=n))}else if(s&&o){if(e.exports==s){o.exports=u}else{for(I in u){u.hasOwnProperty(I)&&(s[I]=u[I])}}}else{i.punycode=u}})(this)}).call(t,r(43)(e),function(){return this}())},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];e.children=[];e.webpackPolyfill=1}return e}},function(e,t){"use strict";e.exports={isString:function(e){return typeof e==="string"},isObject:function(e){return typeof e==="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}},function(e,t,r){"use strict";t.decode=t.parse=r(46);t.encode=t.stringify=r(47)},function(e,t){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&";n=n||"=";var i={};if(typeof e!=="string"||e.length===0){return i}var s=/\+/g;e=e.split(t);var o=1e3;if(a&&typeof a.maxKeys==="number"){o=a.maxKeys}var f=e.length;if(o>0&&f>o){f=o}for(var u=0;u<f;++u){var l=e[u].replace(s,"%20"),h=l.indexOf(n),c,d,p,v;if(h>=0){c=l.substr(0,h);d=l.substr(h+1)}else{c=l;d=""}p=decodeURIComponent(c);v=decodeURIComponent(d);if(!r(i,p)){i[p]=v}else if(Array.isArray(i[p])){i[p].push(v)}else{i[p]=[i[p],v]}}return i}},function(e,t){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){t=t||"&";n=n||"=";if(e===null){e=undefined}if(typeof e==="object"){return Object.keys(e).map(function(a){var i=encodeURIComponent(r(a))+n;if(Array.isArray(e[a])){return e[a].map(function(e){return i+encodeURIComponent(r(e))}).join(t)}else{return i+encodeURIComponent(r(e[a]))}}).join(t)}if(!a)return"";return encodeURIComponent(r(a))+n+encodeURIComponent(r(e))}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=r(49);var s=r(50);var o={escape:function e(t){return t.replace(/'/g,"\\'")},unescape:function e(t){return t.replace(/\\'/g,"'").replace(/^'/,"").replace(/'$/,"")}};var f=function(){n(e,[{key:"parse",value:function e(t,r){var n=t.replace(/\s+/g," ").replace(/\.+$/,"").trim();if(n.match(/^conceptualise an?/i)){return this.newConcept(n,r)}else if(n.match(/^conceptualise the ([a-zA-Z0-9 ]*) ([A-Z0-9]+) (?:has|is|~)/i)){return this.modifyConcept(n,r)}else if(n.match(/^there is an? ([a-zA-Z0-9 ]*) named/i)){return this.newInstance(n,r)}else if(n.match(/^the ([a-zA-Z0-9 ]*)/i)){return this.modifyInstance(n,r)}return[false,null]}},{key:"newConcept",value:function e(t,r){var n=t.match(/^conceptualise an? ~ ([a-zA-Z0-9 ]*) ~ ([A-Z0-9]+)/i);var a=n[1];var s=this.node.getConceptByName(a);var o=null;if(s){return[false,"This concept already exists."]}o=new i(this.node,a,r);var f=t.replace(/^conceptualise an? ~ ([a-zA-Z0-9 ]*) ~ ([A-Z0-9]+) that/,"");var u=f.replace(/\band\b/g,"+").match(/(?:'(?:\\.|[^'])*'|[^+])+/g);var l=true;var h=false;var c=undefined;try{for(var d=u[Symbol.iterator](),p;!(l=(p=d.next()).done);l=true){var v=p.value;this.processConceptFact(o,v,r)}}catch(e){h=true;c=e}finally{try{if(!l&&d.return){d.return()}}finally{if(h){throw c}}}return[true,t,o]}},{key:"modifyConcept",value:function e(t,r){var n=t.match(/^conceptualise the ([a-zA-Z0-9 ]*) ([A-Z0-9]+) (?:has|is|~)/);if(!n){return[false,"Unable to parse sentence"]}var a=n[1];var i=n[2];var s=this.node.getConceptByName(a);if(!s){return[false,"Concept "+n[1]+" not known."]}var o=new RegExp("^conceptualise the "+a+" "+i,"i");var f=t.replace(o,"");var u=f.replace(/\band\b/g,"+").match(/(?:'(?:\\.|[^'])*'|[^+])+/g);var l=true;var h=false;var c=undefined;try{for(var d=u[Symbol.iterator](),p;!(l=(p=d.next()).done);l=true){var v=p.value;this.processConceptFact(s,v,r)}}catch(e){h=true;c=e}finally{try{if(!l&&d.return){d.return()}}finally{if(h){throw c}}}return[true,t,s]}},{key:"processConceptFact",value:function e(t,r,n){var a=r.trim().replace(/\+/g,"and");if(a.match(/has the ([a-zA-Z0-9 ]*) ([A-Z0-9]+) as ~ ([a-zA-Z0-9 ]*) ~/g)){var i=/has the ([a-zA-Z0-9 ]*) ([A-Z0-9]+) as ~ ([a-zA-Z0-9 ]*) ~/g;var s=i.exec(a);var o=s[1];var f=s[3];var u=o==="value"?0:this.node.getConceptByName(o);t.addValue(f,u,n)}if(a.match(/^is an? ([a-zA-Z0-9 ]*)/)){var l=/^is an? ([a-zA-Z0-9 ]*)/;var h=l.exec(a);var c=h[1];var d=this.node.getConceptByName(c);if(d){t.addParent(d)}}if(a.match(/~ ([a-zA-Z0-9 ]*) ~ the ([a-zA-Z0-9 ]*) ([A-Z0-9]+)/)){var p=/~ ([a-zA-Z0-9 ]*) ~ the ([a-zA-Z0-9 ]*) ([A-Z0-9]+)/;var v=p.exec(a);var y=v[1];var m=v[2];var g=this.node.getConceptByName(m);if(g){t.addRelationship(y,g,n)}}if(a.match(/~ is expressed by ~ ([a-zA-Z0-9 ]*)/)){var b=/~ is expressed by ~ ([a-zA-Z0-9 ]*)/;var w=b.exec(a);var _=w[1];t.addSynonym(_)}}},{key:"newInstance",value:function e(t,r){var n=t.match(/^there is an? ([a-zA-Z0-9 ]*) named '([^'\\]*(?:\\.[^'\\]*)*)'/i);if(!n){n=t.match(/^there is an? ([a-zA-Z0-9 ]*) named ([a-zA-Z0-9_]*)/i);if(!n){return[false,"Unable to determine name of instance."]}}var a=n[1];var i=n[2].replace(/\\/g,"");var o=this.node.getConceptByName(a);var f=this.node.getInstanceByName(i,o);if(!o){return[false,"Instance type unknown: "+a]}if(f&&f.type.id===o.id){return[false,"There is already an instance of this type with this name.",f]}var u=new s(this.node,o,i,r);u.sentences.push(t);var l=t.replace(/^there is an? (?:[a-zA-Z0-9 ]*) named (?:[a-zA-Z0-9_]*|'[a-zA-Z0-9_ ]*') that/,"");var h=l.replace(/\band\b/g,"+").match(/(?:'(?:\\.|[^'])*'|[^+])+/g);var c=true;var d=false;var p=undefined;try{for(var v=h[Symbol.iterator](),y;!(c=(y=v.next()).done);c=true){var m=y.value;this.processInstanceFact(u,m,r)}}catch(e){d=true;p=e}finally{try{if(!c&&v.return){v.return()}}finally{if(d){throw p}}}return[true,t,u]}},{key:"modifyInstance",value:function e(t,r){var n=void 0;var a=void 0;var i=void 0;if(t.match(/^the ([a-zA-Z0-9 ]*) '([^'\\]*(?:\\.[^'\\]*)*)'/i)){var s=t.match(/^the ([a-zA-Z0-9 ]*) '([^'\\]*(?:\\.[^'\\]*)*)'/i);if(s){n=this.node.getConceptByName(s[1]);i=s[2].replace(/\\/g,"");a=this.node.getInstanceByName(i,n)}}if(!a&&t.match(/^the ([a-zA-Z0-9 ]*)/i)){var o=t.match(/^the ([a-zA-Z0-9 ]*)/i);var f=o[1].split(" ");var u=true;var l=false;var h=undefined;try{for(var c=this.node.concepts[Symbol.iterator](),d;!(u=(d=c.next()).done);u=true){var p=d.value;if(o[1].toLowerCase().indexOf(p.name.toLowerCase())===0){n=p;i=f[n.name.split(" ").length];a=this.node.getInstanceByName(i,n);break}}}catch(e){l=true;h=e}finally{try{if(!u&&c.return){c.return()}}finally{if(l){throw h}}}}if(!n||!a){return[false,"Unknown concept/instance combination in: "+t]}a.sentences.push(t);var v=t.split(" ");v.splice(0,1+n.name.split(" ").length+i.split(" ").length);var y=v.join(" ");var m=y.replace(/\band\b/g,"+").match(/(?:'(?:\\.|[^'])*'|[^+])+/g);if(m){var g=true;var b=false;var w=undefined;try{for(var _=m[Symbol.iterator](),C;!(g=(C=_.next()).done);g=true){var A=C.value;this.processInstanceFact(a,A,r)}}catch(e){b=true;w=e}finally{try{if(!g&&_.return){_.return()}}finally{if(b){throw w}}}}return[true,t,a]}},{key:"processInstanceFact",value:function e(t,r,n){var a=r.trim().replace(/\+/g,"and");if(a.match(/^(?!has)([a-zA-Z0-9 ]*) the ([a-zA-Z0-9 ]*) ([a-zA-Z0-9_' ]*)/)){var i=/^(?!has)([a-zA-Z0-9 ]*) the ([a-zA-Z0-9 ]*) ([a-zA-Z0-9_' ]*)/;var f=i.exec(a);var u=f[1];var l=f[2];var h=f[3].replace(/'/g,"");var c=this.node.getConceptByName(l);var d=this.node.getInstanceByName(h,c);if(!d){d=new s(this.node,c,h,n)}t.addRelationship(u,d,true,n)}if(a.match(/^has ([a-zA-Z0-9]*|'[^'\\]*(?:\\.[^'\\]*)*') as ([a-zA-Z0-9 ]*)/)){var p=/^has ([a-zA-Z0-9]*|'[^'\\]*(?:\\.[^'\\]*)*') as ([a-zA-Z0-9 ]*)/;var v=p.exec(a);var y=o.unescape(v[1]);var m=v[2];t.addValue(m,y,true,n)}if(a.match(/^has the ([a-zA-Z0-9 ]*) ([a-zA-Z0-9_]*|'[a-zA-Z0-9_ ]*') as ([a-zA-Z0-9 ]*)/)){var g=/^has the ([a-zA-Z0-9 ]*) ([a-zA-Z0-9]*|'[a-zA-Z0-9 ]*') as ([a-zA-Z0-9 ]*)/;var b=g.exec(a);var w=b[1];var _=b[2].replace(/'/g,"");var C=b[3];var A=this.node.getConceptByName(w);var x=this.node.getInstanceByName(_,A);if(!x){x=new s(this.node,A,_,n)}t.addValue(C,x,true,n)}if(a.match(/(?:is| )?an? ([a-zA-Z0-9 ]*)/g)){var S=/(?:is| )?an? ([a-zA-Z0-9 ]*)/g;var I=S.exec(a);t.addSubConcept(this.node.getConceptByName(I&&I[1]&&I[1].trim()))}if(a.match(/is expressed by ('[a-zA-Z0-9 ]*'|[a-zA-Z0-9]*)/)){var k=a.match(/is expressed by ('[a-zA-Z0-9 ]*'|[a-zA-Z0-9]*)/);var E=k&&k[1]&&k[1].replace(/'/g,"").trim();t.addSynonym(E)}}}]);function e(t){a(this,e);this.node=t}return e}();e.exports=f},function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r,a){var i=this;n(this,e);if(!r){return}var s=true;var o=false;var f=undefined;try{for(var u=t.concepts[Symbol.iterator](),l;!(s=(l=u.next()).done);s=true){var h=l.value;if(h.name.toLowerCase()===r.toLowerCase()){return}}}catch(e){o=true;f=e}finally{try{if(!s&&u.return){u.return()}}finally{if(o){throw f}}}this.name=r;this.source=a;this.id=t.newConceptId();this.node=t;this.parentIds=[];this.valueIds=[];this.relationshipIds=[];this.synonyms=[];t.concepts.push(this);this.node.conceptDict[this.id]=this;if(isNaN(r[0])){(function(){var e=i;Object.defineProperty(t.concepts,r.toLowerCase().replace(/ /g,"_"),{get:function t(){return e},configurable:true})})()}}r(e,[{key:"getCE",value:function e(t){var r="";if(t){r+="conceptualise the "+this.name+" "+this.name.charAt(0).toUpperCase()}else{r+="conceptualise a ~ "+this.name+" ~ "+this.name.charAt(0).toUpperCase()}if(!t&&(this.parentIds.length>0||this.valueIds.length>0||this.relationshipIds.length>0)){r+=" that"}if(this.parentIds.length>0){for(var n=0;n<this.parents.length;n+=1){r+=" is a "+this.parents[n].name;if(n<this.parents.length-1){r+=" and"}}}var a=[];var i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"];for(var s=0;s<this.valueIds.length;s+=1){if(this.valueIds[s].type===0){a.push("has the value "+i[s]+" as ~ "+this.valueIds[s].label+" ~")}else{var o=this.node.getConceptById(this.valueIds[s].type);a.push("has the "+o.name+" "+o.name.charAt(0).toUpperCase()+" as ~ "+this.valueIds[s].label+" ~")}}for(var f=0;f<this.relationshipIds.length;f+=1){var u=this.node.getConceptById(this.relationshipIds[f].target);a.push("~ "+this.relationshipIds[f].label+" ~ the "+u.name+" "+i[f])}if(a.length>0){if(this.parentIds.length>0){r+=" and"}r+=" "+a.join(" and ")}r+=".";return r}},{key:"addValue",value:function e(t,r,n){var a={};a.source=n;a.label=t;a.type=typeof r==="number"?r:r.id;this.valueIds.push(a);if(isNaN(t[0])){Object.defineProperty(this,t.toLowerCase().replace(/ /g,"_"),{get:function e(){return r===0?"value":r},configurable:true})}}},{key:"addRelationship",value:function e(t,r,n){var a={};a.source=n;a.label=t;a.target=r.id;this.relationshipIds.push(a);if(isNaN(t[0])){Object.defineProperty(this,t.toLowerCase().replace(/ /g,"_"),{get:function e(){return r},configurable:true})}}},{key:"addParent",value:function e(t){if(this.parentIds.indexOf(t.id)===-1){this.parentIds.push(t.id)}}},{key:"addSynonym",value:function e(t){var r=true;var n=false;var a=undefined;try{for(var i=this.synonyms[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.toLowerCase()===t.toLowerCase()){return}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}this.synonyms.push(t)}},{key:"instances",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.node.instances[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.concept.id===this.id){t.push(o)}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"allInstances",get:function e(){var t=this.descendants.concat(this);var r=[];var n=true;var a=false;var i=undefined;try{for(var s=this.node.instances[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;var u=true;var l=false;var h=undefined;try{for(var c=t[Symbol.iterator](),d;!(u=(d=c.next()).done);u=true){var p=d.value;if(f.concept.id===p.id){r.push(f)}}}catch(e){l=true;h=e}finally{try{if(!u&&c.return){c.return()}}finally{if(l){throw h}}}}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}return r}},{key:"parents",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.parentIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;t.push(this.node.getConceptById(o))}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"ancestors",get:function e(){var t=[];var r=[];var n=true;var a=false;var i=undefined;try{for(var s=this.parents[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;r.push(f)}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}while(r.length>0){var u=r.pop();t.push(u);var l=true;var h=false;var c=undefined;try{for(var d=u.parents[Symbol.iterator](),p;!(l=(p=d.next()).done);l=true){var v=p.value;r.push(v)}}catch(e){h=true;c=e}finally{try{if(!l&&d.return){d.return()}}finally{if(h){throw c}}}}return t}},{key:"children",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.node.concepts[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;var f=true;var u=false;var l=undefined;try{for(var h=o.parents[Symbol.iterator](),c;!(f=(c=h.next()).done);f=true){var d=c.value;if(d.id===this.id){t.push(o)}}}catch(e){u=true;l=e}finally{try{if(!f&&h.return){h.return()}}finally{if(u){throw l}}}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"descendants",get:function e(){var t=[];var r=[];var n=true;var a=false;var i=undefined;try{for(var s=this.children[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;r.push(f)}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}while(r.length>0){var u=r.pop();t.push(u);var l=u.children;if(l){var h=true;var c=false;var d=undefined;try{for(var p=l[Symbol.iterator](),v;!(h=(v=p.next()).done);h=true){var y=v.value;r.push(y)}}catch(e){c=true;d=e}finally{try{if(!h&&p.return){p.return()}}finally{if(c){throw d}}}}}return t}},{key:"relationships",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.relationshipIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;var f={};f.label=o.label;f.concept=this.node.getConceptById(o.target);t.push(f)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"values",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.valueIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;var f={};f.label=o.label;f.concept=o.type&&this.node.getConceptById(o.type);t.push(f)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"creationCE",get:function e(){return"conceptualise a ~ "+this.name+" ~ "+this.name.charAt(0).toUpperCase()}},{key:"ce",get:function e(){return this.getCE()}},{key:"gist",get:function e(){var t="";if(this.parentIds.length>0){t+="A "+this.name}for(var r in this.parents){t+=" is a type of "+this.parents[r].name;if(r<this.parents.length-1){t+=" and"}}if(this.parentIds.length>0){t+="."}var n=[];for(var a=0;a<this.valueIds.length;a+=1){if(this.valueIds[a].type===0){n.push("has a value called "+this.valueIds[a].label)}else{var i=this.node.getConceptById(this.valueIds[a].type);n.push("has a type of "+i.name+" called "+this.valueIds[a].label)}}for(var s=0;s<this.relationshipIds.length;s+=1){var o=this.node.getConceptById(this.relationshipIds[s].target);n.push(this.relationshipIds[s].label+" a type of "+o.name)}if(n.length>0){t+=" An instance of "+this.name+" "+n.join(" and ")+"."}else if(n.length===0&&this.parents.length===0){t+="A "+this.name+" has no attributes or relationships."}return t}}]);return e}();e.exports=a},function(e,t){"use strict";var r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function(){function e(t,r,n,i){var s=this;a(this,e);if(!r||!n){return}var o=true;var f=false;var u=undefined;try{for(var l=t.instances[Symbol.iterator](),h;!(o=(h=l.next()).done);o=true){var c=h.value;if(c.name.toLowerCase()===n.toLowerCase()&&r.id===c.concept.id){return}}}catch(e){f=true;u=e}finally{try{if(!o&&l.return){l.return()}}finally{if(f){throw u}}}this.node=t;this.name=n;this.source=i;this.id=t.newInstanceId();this.concept=r;this.conceptId=r.id;this.subConcepts=[];this.sentences=[];this.valueIds=[];this.relationshipIds=[];this.synonyms=[];this.reservedFields=["values","relationships","synonyms","addValue","addRelationship","name","concept","id","instance","sentences","ce","gist"];t.instances.push(this);this.node.instanceDict[this.id]=this;if(isNaN(n[0])){(function(){var e=s;var a=n.toLowerCase().replace(/ /g,"_").replace(/'/g,"");Object.defineProperty(t.instances,a,{get:function t(){return e},configurable:true});Object.defineProperty(r,a,{get:function t(){return e},configurable:true})})()}}n(e,[{key:"addSentence",value:function e(t){this.sentences.push(t)}},{key:"getPossibleProperties",value:function e(){var t=this.concept.ancestors;t.push(this.concept);var r=true;var n=false;var a=undefined;try{for(var i=this.subConcepts[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;t.push(o);t=t.concat(o.ancestors)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}var f={values:[],relationships:[]};var u=true;var l=false;var h=undefined;try{for(var c=t[Symbol.iterator](),d;!(u=(d=c.next()).done);u=true){var p=d.value;var v=true;var y=false;var m=undefined;try{for(var g=p.values[Symbol.iterator](),b;!(v=(b=g.next()).done);v=true){var w=b.value;f.values.push(w.label.toLowerCase())}}catch(e){y=true;m=e}finally{try{if(!v&&g.return){g.return()}}finally{if(y){throw m}}}var _=true;var C=false;var A=undefined;try{for(var x=p.relationships[Symbol.iterator](),S;!(_=(S=x.next()).done);_=true){var I=S.value;f.relationships.push(I.label.toLowerCase())}}catch(e){C=true;A=e}finally{try{if(!_&&x.return){x.return()}}finally{if(C){throw A}}}}}catch(e){l=true;h=e}finally{try{if(!u&&c.return){c.return()}}finally{if(l){throw h}}}return f}},{key:"addValue",value:function e(t,n,a,i){var s=this;if(!(t&&t.length&&n)){return null}if(this.getPossibleProperties().values.indexOf(t.toLowerCase())>-1){(function(){var e={};e.source=i;e.label=t;e.conceptId=(typeof n==="undefined"?"undefined":r(n))==="object"?n.id:0;e.typeName=(typeof n==="undefined"?"undefined":r(n))==="object"?n.name:n;s.valueIds.push(e);var o=t.toLowerCase().replace(/ /g,"_");if(s.reservedFields.indexOf(o)===-1&&isNaN(o[0])){Object.defineProperty(s,o,{get:function t(){return e.conceptId===0?e.typeName:this.node.getInstanceById(e.conceptId)},configurable:true});if(s.reservedFields.indexOf(o+"s")===-1&&!Object.prototype.hasOwnProperty.call(s,o+"s")){Object.defineProperty(s,o+"s",{get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.valueIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var f=s.value;if(f.label.toLowerCase().replace(/ /g,"_")===o){t.push(f.conceptId===0?f.typeName:this.node.getInstanceById(f.conceptId))}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}})}}if(a!==false){s.node.ruleEngine.enactRules(s,"value",n,i)}})()}return null}},{key:"addRelationship",value:function e(t,r,n,a){var i=this;if(this.getPossibleProperties().relationships.indexOf(t.toLowerCase())>-1){(function(){var e={};e.label=t;e.source=a;e.targetId=r.id;e.targetName=r.name;i.relationshipIds.push(e);var s=t.toLowerCase().replace(/ /g,"_");if(i.reservedFields.indexOf(s)===-1&&isNaN(s[0])){Object.defineProperty(i,s,{get:function t(){return this.node.getInstanceById(e.targetId)},configurable:true});if(i.reservedFields.indexOf(s+"s")===-1&&!Object.prototype.hasOwnProperty.call(i,s+"s")){Object.defineProperty(i,s+"s",{get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.relationshipIds[Symbol.iterator](),o;!(r=(o=i.next()).done);r=true){var f=o.value;if(f.label.toLowerCase().replace(/ /g,"_")===s){t.push(this.node.getInstanceById(f.targetId))}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}})}}if(n!==false){i.node.ruleEngine.enactRules(i,"relationship",r,a)}})()}return null}},{key:"addSynonym",value:function e(t){if(!t||!t.length){return null}var r=true;var n=false;var a=undefined;try{for(var i=this.synonyms[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;if(o.toLowerCase()===t.toLowerCase()){return null}}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}this.synonyms.push(t);if(isNaN(t[0])){Object.defineProperty(this,t.toLowerCase().replace(/ /g,"_"),{get:function e(){return this}})}return null}},{key:"addSubConcept",value:function e(t){if(!t){return}var r=true;var n=true;var a=false;var i=undefined;try{for(var s=this.subConcepts[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){var f=o.value;if(f.id===t.id||t.id===this.concept.id){r=false;break}}}catch(e){a=true;i=e}finally{try{if(!n&&s.return){s.return()}}finally{if(a){throw i}}}if(r){this.subConcepts.push(t)}}},{key:"property",value:function e(t,r){return this.properties(t,r,true)}},{key:"properties",value:function e(t,r,n){var e=[];for(var a=this.values.length-1;a>=0;a-=1){if(this.values[a].label.toLowerCase()===t.toLowerCase()){var i=this.values[a].instance;var s=r?{instance:i,source:this.values[a].source}:i;if(n){return s}e.push(s)}}for(var o=this.relationships.length-1;o>=0;o-=1){if(this.relationships[o].label.toLowerCase()===t.toLowerCase()){var f=this.relationships[o].instance;var u=r?{instance:f,source:this.relationships[o].source}:f;if(n){return u}e.push(u)}}return n?null:e}},{key:"getCE",value:function e(t){var r=this.concept;if(!r){return""}var n="";if(t){n+="the "+r.name+" '"+this.name+"'"}else{n+="there is a "+r.name+" named '"+this.name+"'"}var a=[];var i=true;var s=false;var o=undefined;try{for(var f=this.subConcepts[Symbol.iterator](),u;!(i=(u=f.next()).done);i=true){var l=u.value;a.push("is a "+l.name)}}catch(e){s=true;o=e}finally{try{if(!i&&f.return){f.return()}}finally{if(s){throw o}}}var h=true;var c=false;var d=undefined;try{for(var p=this.valueIds[Symbol.iterator](),v;!(h=(v=p.next()).done);h=true){var y=v.value;if(y.conceptId===0){a.push("has '"+y.typeName.replace(/'/g,"\\'")+"' as "+y.label)}else{var m=this.node.getInstanceById(y.conceptId);var g=m.type;a.push("has the "+g.name+" '"+m.name+"' as "+y.label)}}}catch(e){c=true;d=e}finally{try{if(!h&&p.return){p.return()}}finally{if(c){throw d}}}var b=true;var w=false;var _=undefined;try{for(var C=this.relationshipIds[Symbol.iterator](),A;!(b=(A=C.next()).done);b=true){var x=A.value;var S=this.node.getInstanceById(x.targetId);var I=S.type;a.push(x.label+" the "+I.name+" '"+S.name+"'")}}catch(e){w=true;_=e}finally{try{if(!b&&C.return){C.return()}}finally{if(w){throw _}}}if(a.length>0){n+=(!t&&" that")+" "+a.join(" and ")}return n+"."}},{key:"type",get:function e(){var t=true;var r=false;var n=undefined;try{for(var a=this.node.concepts[Symbol.iterator](),i;!(t=(i=a.next()).done);t=true){var s=i.value;if(s.id===this.concept.id){return s}}}catch(e){r=true;n=e}finally{try{if(!t&&a.return){a.return()}}finally{if(r){throw n}}}return null}},{key:"relationships",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.relationshipIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;var f={};f.label=o.label;f.source=o.source;f.instance=this.node.getInstanceById(o.targetId);t.push(f)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"values",get:function e(){var t=[];var r=true;var n=false;var a=undefined;try{for(var i=this.valueIds[Symbol.iterator](),s;!(r=(s=i.next()).done);r=true){var o=s.value;var f={};f.label=o.label;f.source=o.source;if(o.conceptId===0){f.instance=o.typeName}else{f.instance=this.node.getInstanceById(o.conceptId)}t.push(f)}}catch(e){n=true;a=e}finally{try{if(!r&&i.return){i.return()}}finally{if(n){throw a}}}return t}},{key:"creationCE",get:function e(){return"there is a "+(this.concept&&this.concept.name)+" named '"+this.name+"'"}},{key:"ce",get:function e(){return this.getCE()}},{key:"gist",get:function e(){var t=["a","e","i","o","u"];var r=this.concept;if(!r){return""}var n=this.name+" is";if(t.indexOf(r.name.toLowerCase()[0])>-1){n+=" an "+r.name}else{n+=" a "+r.name}var a=true;var i=false;var s=undefined;try{for(var o=this.subConcepts[Symbol.iterator](),f;!(a=(f=o.next()).done);a=true){var u=f.value;n+=" and "+(t.indexOf(u.name.toLowerCase()[0])>-1?"an":"a")+" "+u.name}}catch(e){i=true;s=e}finally{try{if(!a&&o.return){o.return()}}finally{if(i){throw s}}}n+=".";var l={};var h=false;var c=true;var d=false;var p=undefined;try{for(var v=this.valueIds[Symbol.iterator](),y;!(c=(y=v.next()).done);c=true){var m=y.value;h=true;var g="";if(m.conceptId===0){g="has '"+m.typeName.replace(/'/g,"\\'")+"' as "+m.label}else{var b=this.node.getInstanceById(m.conceptId);var w=b.type;g="has the "+w.name+" '"+b.name+"' as "+m.label}if(!(g in l)){l[g]=0}l[g]+=1}}catch(e){d=true;p=e}finally{try{if(!c&&v.return){v.return()}}finally{if(d){throw p}}}var _=true;var C=false;var A=undefined;try{for(var x=this.relationshipIds[Symbol.iterator](),S;!(_=(S=x.next()).done);_=true){var I=S.value;h=true;var k=this.node.getInstanceById(I.targetId);var E=k.type;var R=I.label+" the "+E.name+" '"+k.name+"'";if(!(R in l)){l[R]=0}l[R]+=1}}catch(e){C=true;A=e}finally{try{if(!_&&x.return){x.return()}}finally{if(C){throw A}}}if(h){n+=" "+this.name;for(var L in l){n+=" "+L;if(l[L]>1){n+=" ("+l[L]+" times)"}n+=" and"}n=n.substring(0,n.length-4)+"."}return n}}]);return e}();e.exports=i},function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){r(e,[{key:"parse",value:function e(t){var r=t.trim();if(t.match(/^where (is|are)/i)){return this.whereIs(r)}else if(t.match(/^(\bwho\b|\bwhat\b) is(?: \bin?\b | \bon\b | \bat\b)/i)){return this.whatIsIn(r)}else if(t.match(/^(\bwho\b|\bwhat\b) (?:is|are)/i)){
return this.whatIs(r)}else if(t.match(/^(\bwho\b|\bwhat\b) does/i)){return this.whatDoes(r)}else if(t.match(/^(\bwho\b|\bwhat\b)/i)){return this.whatRelationship(r)}else if(t.match(/^list (\ball\b|\binstances\b)/i)){return this.listInstances(r)}return[false,null]}},{key:"whereIs",value:function e(t){var r=t.match(/^where (?:is|are)(?: \ban?\b | \bthe\b | )([a-zA-Z0-9 ]*)/i)[1].replace(/\?/g,"");var n=this.node.getInstanceByName(r);var a=void 0;if(!n){a="I don't know what "+r+" is.";return[true,a]}var i=this.node.getInstances("location",true);var s=[];var o={};var f=false;var u=true;var l=false;var h=undefined;try{for(var c=i[Symbol.iterator](),d;!(u=(d=c.next()).done);u=true){var p=d.value;s.push(p.id)}}catch(e){l=true;h=e}finally{try{if(!u&&c.return){c.return()}}finally{if(l){throw h}}}var v=true;var y=false;var m=undefined;try{for(var g=n.values[Symbol.iterator](),b;!(v=(b=g.next()).done);v=true){var w=b.value;if(s.indexOf(w.instance.id)>-1){var _="has "+w.instance.name+" as "+w.label;if(!(_ in o)){o[_]=0}o[_]+=1;f=true}}}catch(e){y=true;m=e}finally{try{if(!v&&g.return){g.return()}}finally{if(y){throw m}}}var C=true;var A=false;var x=undefined;try{for(var S=n.relationships[Symbol.iterator](),I;!(C=(I=S.next()).done);C=true){var k=I.value;if(s.indexOf(k.instance.id)>-1){var E=k.label+" "+k.instance.name;if(!(E in o)){o[E]=0}o[E]+=1;f=true}}}catch(e){A=true;x=e}finally{try{if(!C&&S.return){S.return()}}finally{if(A){throw x}}}if(!f){a="I don't know where "+n.name+" is.";return[true,a]}a=n.name;for(var R in o){if(R){a+=" "+R;if(o[R]>1){a+=" ("+o[R]+" times)"}a+=" and"}}return[true,a.substring(0,a.length-4)+"."]}},{key:"whatIsIn",value:function e(t){var r=t.match(/^(?:\bwho\b|\bwhat\b) is(?: \bin?\b | \bon\b | \bat\b)([a-zA-Z0-9 ]*)/i)[1].replace(/\?/g,"").replace(/\bthe\b/g,"").replace(/'/g,"");var n=null;var a=this.node.getInstances("location",true);var i=true;var s=false;var o=undefined;try{for(var f=a[Symbol.iterator](),u;!(i=(u=f.next()).done);i=true){var l=u.value;if(r.toLowerCase().indexOf(l.name.toLowerCase())>-1){n=l;break}}}catch(e){s=true;o=e}finally{try{if(!i&&f.return){f.return()}}finally{if(s){throw o}}}if(!n){return[true,r+" is not an instance of type location."]}var h={};var c=false;var d=true;var p=false;var v=undefined;try{for(var y=this.node.instances[Symbol.iterator](),m;!(d=(m=y.next()).done);d=true){var g=m.value;var b=true;var w=false;var _=undefined;try{for(var C=g.values[Symbol.iterator](),A;!(b=(A=C.next()).done);b=true){var x=A.value;if(x.instance.id===n.id){var S="the "+g.type.name+" "+g.name+" has the "+n.type.name+" "+n.name+" as "+x.label;if(!(S in h)){h[S]=0}h[S]+=1;c=true}}}catch(e){w=true;_=e}finally{try{if(!b&&C.return){C.return()}}finally{if(w){throw _}}}var I=true;var k=false;var E=undefined;try{for(var R=g.relationships[Symbol.iterator](),L;!(I=(L=R.next()).done);I=true){var T=L.value;if(T.instance.id===n.id){var O="the "+g.type.name+" "+g.name+" "+T.label+" the "+n.type.name+" "+n.name;if(!(O in h)){h[O]=0}h[O]+=1;c=true}}}catch(e){k=true;E=e}finally{try{if(!I&&R.return){R.return()}}finally{if(k){throw E}}}}}catch(e){p=true;v=e}finally{try{if(!d&&y.return){y.return()}}finally{if(p){throw v}}}if(!c){return[true,"I don't know what is located in/on/at the "+n.type.name+" "+n.name+"."]}var B="";for(var P in h){B+=" "+P;if(h[r]>1){B+=" ("+h[P]+" times)"}B+=" and"}return[true,B.substring(0,B.length-4)+"."]}},{key:"whatIs",value:function e(t){var r=t.replace(/\?/g,"").replace(/'/g,"").replace(/\./g,"");var n=r.match(/^(\bwho\b|\bwhat\b) (?:is|are) ([a-zA-Z0-9_ ]*)/i);var a=void 0;if(n){a=this.node.getInstanceByName(n[2]);if(a){return[true,a.gist]}}n=r.match(/^(?:\bwho\b|\bwhat\b) (?:is|are)(?: \ban?\b | \bthe\b | )([a-zA-Z0-9_ ]*)/i)[1].replace(/\?/g,"").replace(/'/g,"");a=this.node.getInstanceByName(n);if(!a){var i=this.node.getConceptByName(n);if(!i){var s=[];var o=true;var f=false;var u=undefined;try{for(var l=this.node.concepts[Symbol.iterator](),h;!(o=(h=l.next()).done);o=true){var c=h.value;var d=true;var p=false;var v=undefined;try{for(var y=c.values[Symbol.iterator](),m;!(d=(m=y.next()).done);d=true){var g=m.value;var b=g;if(b.label.toLowerCase()===n.toLowerCase()){if(!b.concept){s.push("is a possible value of a type of "+c.name+' (e.g. "the '+c.name+" '"+c.name.toUpperCase()+" NAME' has 'VALUE' as "+n+'")')}else{s.push("is a possible "+b.concept.name+" type of a type of "+c.name+' (e.g. "the '+c.name+" '"+c.name.toUpperCase()+" NAME' has the "+b.concept.name+" '"+b.concept.name.toUpperCase()+" NAME' as "+n+'")')}}}}catch(e){p=true;v=e}finally{try{if(!d&&y.return){y.return()}}finally{if(p){throw v}}}var w=true;var _=false;var C=undefined;try{for(var A=c.relationships[Symbol.iterator](),x;!(w=(x=A.next()).done);w=true){var S=x.value;var I=S;if(I.label.toLowerCase()===n.toLowerCase()){s.push("describes the relationship between a type of "+c.name+" and a type of "+I.concept.name+' (e.g. "the '+c.name+" '"+c.name.toUpperCase()+" NAME' "+n+" the "+I.concept.name+" '"+I.concept.name.toUpperCase()+" NAME'\")")}}}catch(e){_=true;C=e}finally{try{if(!w&&A.return){A.return()}}finally{if(_){throw C}}}}}catch(e){f=true;u=e}finally{try{if(!o&&l.return){l.return()}}finally{if(f){throw u}}}if(s.length>0){return[true,"'"+n+"' "+s.join(" and ")+"."]}var k=this.fuzzySearch(r);var E="I know about ";var R=false;for(var L in k){if(k[L].length>1){for(var T=0;T<k[L].length;T+=1){if(T===0){if(!R){E+="the "+L+"s '"+k[L][T]+"'"}else{E+="The "+L+"s '"+k[L][T]+"'"}}else{E+=", '"+k[L][T]+"'"}if(T===k[L].length-1){E+=". "}}}else if(!R){E+="the "+L+" '"+k[L][0]+"'. "}else{E+="The "+L+" '"+k[L][0]+"'. "}R=true}if(R){return[true,E]}return[true,"I don't know who or what that is."]}return[true,i.gist]}return[true,a.gist]}},{key:"whatDoes",value:function e(t){try{var r=t.match(/^(\bwho\b|\bwhat\b) does ([a-zA-Z0-9_ ]*)/i);var n=r[2].replace(/\ban\b/gi,"").replace(/\bthe\b/gi,"").replace(/\ba\b/gi,"");var a=n.split(" ");var i=void 0;for(var s=0;s<a.length;s+=1){var o=a.slice(0,s).join(" ").trim();if(!i){i=this.node.getInstanceByName(o)}else{break}}if(i){var f=a.splice(i.name.split(" ").length,a.length-1).join(" ").trim();var u=f;var l=i.property(f);if(!l){u=f.replace(/s/gi,"");l=i.property(u)}if(!l){var h=f.split(" ");h[0]=h[0]+"s";u=h.join(" ").trim();l=i.property(u)}if(l){return[true,i.name+" "+u+" the "+l.type.name+" "+l.name+"."]}return[true,"Sorry - I don't know that property about the "+i.type.name+" "+i.name+"."]}}catch(e){return[false,"Sorry - I can't work out what you're asking."]}return null}},{key:"whatRelationship",value:function e(t){var r=t.match(/^(\bwho\b|\bwhat\b) ([a-zA-Z0-9_ ]*)/i);var n=r[2].replace(/\ban\b/gi,"").replace(/\bthe\b/gi,"").replace(/\ba\b/gi,"");var a=n.split(" ");var i=void 0;for(var s=0;s<a.length;s+=1){var o=a.slice(a.length-(s+1),a.length).join(" ").trim();if(!i){i=this.node.getInstanceByName(o)}if(!i&&o[o.length-1].toLowerCase()==="s"){i=this.node.getInstanceByName(o.substring(0,o.length-1))}if(i){break}}if(i){var f=a.splice(0,a.length-i.name.split(" ").length).join(" ").trim();for(var u=0;u<this.node.instances.length;u+=1){var l=this.node.instances[u];var h=f;var c=l.property(f);if(!c){var d=f.split(" ");if(d[0][d[0].length-1].toLowerCase()==="s"){d[0]=d[0].substring(0,d[0].length-1)}h=d.join(" ").trim();c=l.property(h)}if(!c){var p=f.split(" ");p[0]=p[0]+"s";h=p.join(" ").trim();c=l.property(h)}if(c&&c.name===i.name){return[true,l.name+" "+h+" the "+c.type.name+" "+c.name+"."]}}return[true,"Sorry - I don't know that property about the "+i.type.name+" "+i.name+"."]}return null}},{key:"listInstances",value:function e(t){var r=[];var n="";if(t.toLowerCase().indexOf("list instances of type")===0){var a=t.toLowerCase().replace("list instances of type","").trim();r=this.node.getInstances(a);n="Instances of type '"+a+"':"}else if(t.toLowerCase().indexOf("list all instances of type")===0){var i=t.toLowerCase().replace("list all instances of type","").trim();r=this.node.getInstances(i,true);n="All instances of type '"+i+"':"}else if(t.toLowerCase()==="list instances"){r=this.node.getInstances();n="All instances:"}if(r.length===0){return[true,"I could not find any instances matching your query."]}var s=[];for(var o=0;o<r.length;o+=1){s.push(r[o].name)}return[true,n+" "+s.join(", ")]}},{key:"fuzzySearch",value:function e(t){var r=t.match(/^(?:\bwho\b|\bwhat\b) (?:is|are)(?: \ban?\b | \bthe\b | )([a-zA-Z0-9_ ]*)/i)[1].replace(/\?/g,"").replace(/'/g,"");var n=this.node.getInstances();var a=void 0;var i=[];if(r.indexOf(" ")){a=r.split(" ")}if(a){var s=function e(t){var r=n.filter(function(e){if(e.name.toUpperCase().includes(a[t].toUpperCase())){return e}return null});i=i.concat(r)};for(var o=0;o<a.length;o+=1){s(o)}}else{i=n.filter(function(e){if(e.name.toUpperCase().includes(r.toUpperCase())){return e}return null})}var f=i.reduce(function(e,t){var r=e;if(!r[t.type.name]){r[t.type.name]=[]}r[t.type.name].push(t.name);return r},{});return f}}]);function e(t){n(this,e);this.node=t}return e}();e.exports=a},function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){r(e,[{key:"parse",value:function e(t){var r=t.replace(/'/g,"").replace(/\./g,"");var n=r.split(" ");var a=r.split(/\band\b/);var i=["there","what","who","where","theres","is","as","and","has","that","the","a","an","named","called","name","with","conceptualise","on","at","in"];var s=null;var o=999999;for(var f=0;f<this.node.instances.length;f+=1){var u=this.node.instances[f].synonyms.concat(this.node.instances[f].name);for(var l=0;l<u.length;l+=1){if(r.toLowerCase().indexOf(u[l].toLowerCase())>-1){if(r.toLowerCase().indexOf(u[l].toLowerCase())<o){s=this.node.instances[f];o=r.toLowerCase().indexOf(u[l].toLowerCase());break}}}}if(s){var h=s.type;var c=s.name.toLowerCase().split(" ");var d=h.name.toLowerCase().split(" ");for(var p=0;p<c.length;p+=1){i.push(c[p])}for(var v=0;v<d.length;v+=1){i.push(d[v])}var y="the "+h.name+" '"+s.name+"' ";var m=[];var g=h.ancestors;g.push(h);var b=[];var w=[];for(var _=0;_<g.length;_+=1){b=b.concat(g[_].relationships);w=w.concat(g[_].values)}for(var C=0;C<a.length;C+=1){var A=a[C].toLowerCase();var x=A.split(" ");for(var S=0;S<w.length;S+=1){var I=w[S].label.toLowerCase().split(" ");for(var k=0;k<I.length;k+=1){i.push(I[k])}if(w[S].concept){var E=w[S].concept;var R=this.node.getInstances(E.name,true);for(var L=0;L<R.length;L+=1){var T=R[L].synonyms.concat(R[L].name);for(var O=0;O<T.length;O+=1){if(A.toLowerCase().indexOf(T[O].toLowerCase())>-1){m.push("has the "+E.name+" '"+R[L].name+"' as "+w[S].label);break}}}}else if(A.toLowerCase().indexOf(w[S].label.toLowerCase())>-1){var B="";for(var P=0;P<x.length;P+=1){if(i.indexOf(x[P].toLowerCase())===-1){B+=x[P]+" "}}if(B!==""){m.push("has '"+B.trim()+"' as "+w[S].label)}}}var M=[];for(var U=0;U<b.length;U+=1){if(b[U].concept){var j=b[U].concept;var N=this.node.getInstances(j.name,true);for(var z=0;z<N.length;z+=1){var Z=N[z].synonyms.concat(N[z].name);for(var D=0;D<Z.length;D+=1){var q=A.toLowerCase().indexOf(" "+Z[D].toLowerCase());if(q>-1&&M.indexOf(q)===-1){m.push(b[U].label+" the "+j.name+" '"+N[z].name+"'");M.push(q);break}}}}}}if(m.length>0){return[true,y+m.join(" and ")]}}for(var F=0;F<this.node.concepts.length;F+=1){if(r.toLowerCase().indexOf(this.node.concepts[F].name.toLowerCase())>-1){var H=this.node.concepts[F].name.toLowerCase().split(" ");i.push(this.node.concepts[F].name.toLowerCase());for(var Y=0;Y<H;Y+=1){i.push(H[Y])}var W="";for(var V=0;V<n.length;V+=1){if(i.indexOf(n[V].toLowerCase())===-1){W+=n[V]+" "}}if(W&&W.length){return[true,"there is a "+this.node.concepts[F].name+" named '"+W.trim()+"'"]}return[true,"there is a "+this.node.concepts[F].name+" named '"+this.node.concepts[F].name+" "+this.node.instances.length+1+"'"]}}return[false,"Un-parseable input: "+r]}},{key:"guessNext",value:function e(t){var r=t.trim().toLowerCase();var n=t.split(" ");var a=0;var i=0;for(var s=0;s<n.length;s+=1){if(n[s]==="~"){a+=1;if(a===1){i=s}}}var o=[];if(t===""){return t}if(a===1){try{return t+" ~ "+n[i+1].charAt(0).toUpperCase()+" "}catch(e){}}if(r.match(/^conceptualise a ~ (.*) ~ [A-Z] /)){return t+" that "}if(n.length<2){o.push("conceptualise a ~ ");o.push("there is a ");o.push("where is ");o.push("what is ");o.push("who is ")}if(n.length>2){o.push("named '");o.push("that ");o.push("is a ");o.push("and is ");o.push("and has the ");o.push("the ")}var f=[];if(r.indexOf("there is")===-1||n.length===1){for(var u=0;u<this.node.instances.length;u+=1){o.push(this.node.instances[u].name);if(r.indexOf(this.node.instances[u].name.toLowerCase())>-1){f.push(this.node.instances[u])}}}for(var l=0;l<this.node.concepts.length;l+=1){o.push(this.node.concepts[l].name);var h=false;for(var c=0;c<f.length;c+=1){if(f[c].conceptId===this.node.concepts[l].id){h=true;break}}if(r.indexOf(this.node.concepts[l].name.toLowerCase())>-1||h){for(var d=0;d<this.node.concepts[l].values.length;d+=1){o.push(this.node.concepts[l].values[d].label)}for(var p=0;p<this.node.concepts[l].relationships.length;p+=1){o.push(this.node.concepts[l].relationships[p].label)}}}for(var v=0;v<o.length;v+=1){if(o[v].toLowerCase().indexOf(n[n.length-1].toLowerCase())===0){n[n.length-1]=o[v];return n.join(" ")}}return t}}]);function e(t){n(this,e);this.node=t}return e}();e.exports=a},function(e,t){"use strict";var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){r(e,[{key:"enactRules",value:function t(r,n,a,i){if(typeof a==="string"){return}var s=this.node.getInstances("rule");for(var o=0;o<s.length;o+=1){var f=e.parseRule(s[o].instruction);if(!f){return}if(f.if.concept===r.type.name){if(n==="relationship"&&f.if.relationship||n==="value"&&f.if.value){var u=a.type.ancestors;u.push(a.type);for(var l=0;l<u.length;l+=1){if(u[l].name.toLowerCase()===f.if[n].type.toLowerCase()){if(f.then.relationship&&f.then.relationship.type===r.type.name){a.addRelationship(f.then.relationship.label,r,false,i)}else if(f.then.value&&f.then.value.type===r.type.name){a.addValue(f.then.value.label,r,false,i)}}}}}}}}],[{key:"parseRule",value:function e(t){if(!t){return null}var r={};var n=null;var a=t.match(/^if the ([a-zA-Z0-9 ]*) ([A-Z]) ~ (.*) ~ the ([a-zA-Z0-9 ]*) ([A-Z]) then the (.*)/i);var i=t.match(/^if the ([a-zA-Z0-9 ]*) ([A-Z]) has the ([a-zA-Z0-9 ]*) ([A-Z]) as ~ (.*) ~ then the (.*)/i);if(a){r.if={};r.if.concept=a[1];r.if.relationship={};r.if.relationship.type=a[4];r.if.relationship.label=a[3];n=a[6]}else if(i){r.if={};r.if.concept=i[1];r.if.value={};r.if.value.type=i[3];r.if.value.label=i[5];n=i[6]}if(n){var s=n.match(/^([a-zA-Z0-9 ]*) ([A-Z]) ~ (.*) ~ the ([a-zA-Z0-9 ]*) ([A-Z])/i);var o=n.match(/^([a-zA-Z0-9 ]*) ([A-Z]) has the ([a-zA-Z0-9 ]*) ([A-Z]) as ~ (.*) ~/i);if(s){r.then={};r.then.concept=s[1];r.then.relationship={};r.then.relationship.type=s[4];r.then.relationship.label=s[3]}else if(o){r.then={};r.then.concept=o[1];r.then.value={};r.then.value.type=o[3];r.then.value.label=o[5]}}return r}}]);function e(t){n(this,e);this.node=t}return e}();e.exports=a}]);
//# sourceMappingURL=dist/cenode.js.map